<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="3.5.0">Jekyll</generator><link href="http://localhost:4000/feed.xml" rel="self" type="application/atom+xml" /><link href="http://localhost:4000/" rel="alternate" type="text/html" /><updated>2017-08-06T23:12:30+08:00</updated><id>http://localhost:4000/</id><title type="html">Matt Reach</title><subtitle>&lt;p&gt;æ»šæ»šä¸œé€æ°´ï¼Œæ·˜å°½è‹±é›„æ³ªã€‚&lt;/p&gt;&lt;p&gt;é’å±±ä¾æ—§åœ¨ï¼Œå‡ åº¦å¤•é˜³çº¢ã€‚ &lt;/p&gt;&lt;p&gt;å¤ä»Šå¤šå°‘äº‹ï¼Œéƒ½ä»˜ç¬‘è°ˆä¸­ã€‚&lt;/p&gt;</subtitle><author><name>è®¸ä¹¾éš†</name><email>qianlongxu@gmail.com</email></author><entry><title type="html">ä½¿ç”¨ CocoaPods ç®¡ç† frameworks</title><link href="http://localhost:4000/ios/cocoapods/2017/07/21/use-cocoapods-manager-frameworks/" rel="alternate" type="text/html" title="ä½¿ç”¨ CocoaPods ç®¡ç† frameworks" /><published>2017-07-21T15:09:56+08:00</published><updated>2017-07-21T15:09:56+08:00</updated><id>http://localhost:4000/ios/cocoapods/2017/07/21/use-cocoapods-manager-frameworks</id><content type="html" xml:base="http://localhost:4000/ios/cocoapods/2017/07/21/use-cocoapods-manager-frameworks/">&lt;blockquote&gt;
  &lt;p&gt;ä¸Šç¯‡åšå®¢ä»‹ç»äº†å¦‚ä½•åˆ›å»º pods åº“ï¼Œè®© pods åº“å¸®æˆ‘ä»¬ç®¡ç†æºç ã€ä¾èµ–ã€ç¼–è¯‘æˆåº“ã€é…ç½®search pathç­‰å·¥ä½œï¼›ä½†æœ‰æ—¶å€™ä½ å¯èƒ½ä¸æƒ³æˆ–è€…ä¸èƒ½æŠŠæºç æä¾›å‡ºå»ï¼Œè¿˜æƒ³è¦ä½¿ç”¨ pods ç®¡ç†ç‰ˆæœ¬çš„è¯ï¼Œå°±å¯ä»¥è®© pods ç›´æ¥ç®¡ç† frameworks è€Œä¸æ˜¯æºç ï¼&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;æˆ‘å·²ç»å®è·µäº†è¿‡äº†ï¼Œç¡®å®å¯ä»¥ç®¡ç† framework çš„ï¼Œè¿™æ˜¯åˆ›å»ºå¥½çš„åŒ…å« demo çš„ pods åº“åœ°å€ ï¼š&lt;a href=&quot;https://github.com/debugly/TestSCFPods&quot;&gt;https://github.com/debugly/TestSCFPods&lt;/a&gt;ã€‚&lt;/p&gt;

&lt;p&gt;åˆ›å»ºæ­¥éª¤å’Œåˆ›å»ºç®¡ç†æºç çš„ pods åº“æ˜¯ä¸€æ ·çš„ï¼Œåªä¸è¿‡ podspec é‡Œçš„é…ç½®ä¸å¤ªä¸€æ ·è€Œå·²ï¼å¦‚æœä½ æ²¡æœ‰åˆ›å»ºè¿‡ pods åº“çš„è¯ï¼Œæœ€å¥½å…ˆå»çœ‹ä¸‹ä¸Šç¯‡åšå®¢ : &lt;a href=&quot;/ios/2017/07/20/create-pod-library.html#0&quot;&gt;åˆ›å»º CocoaPods åº“&lt;/a&gt;ã€‚&lt;/p&gt;

&lt;h1 id=&quot;åˆ›å»º-git-ä»“åº“&quot;&gt;åˆ›å»º git ä»“åº“&lt;/h1&gt;

&lt;p&gt;åŒæ ·çš„ï¼Œæˆ‘ä»¬éœ€è¦å…ˆåˆ›å»ºä¸€ä¸ª git ä»“åº“ï¼Œç”¨äºç®¡ç† frameworks çš„ç‰ˆæœ¬ï¼Œå¹¶ä¸”æ‰“ tagã€‚ç„¶åå…‹éš†åˆ°æœ¬åœ°ï¼Œè¿›å…¥ä»“åº“ç›®å½• :&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;cd ~/GitWorkspace/TestSCFPods
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h1 id=&quot;åˆ›å»º-podspec-æ–‡ä»¶&quot;&gt;åˆ›å»º podspec æ–‡ä»¶&lt;/h1&gt;

&lt;p&gt;è¿›å…¥ä»“åº“ç›®å½•åï¼Œå¼€å§‹åˆ›å»º podspec æ–‡ä»¶&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;pod spec create TestSCFPods

Specification created at TestSCFPods.podspec
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;æˆ‘æŠŠå’Œåˆ›å»ºæ™®é€šæºç  pods åº“ä¸ä¸€æ ·çš„åœ°æ–¹æ‹¿å‡ºæ¥è¯´ä¸‹ï¼š&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;//ä¸Šç¯‡åšå®¢é‡Œæ²¡ç”¨åˆ°ï¼Œå› æ­¤æ²¡æï¼›è¿™ä¸ªæ˜¯èµ„æºè·¯å¾„ï¼Œæˆ‘çš„ SohuGameSDK.framework é‡ŒåŒ…å«çš„æœ‰ SohuGame.xcassets è¿™ä¸ªå›¾ç‰‡åº“ï¼›
s.resources = &quot;SohuGameSDK.framework/SohuGame.xcassets&quot;
///è¿™ä¸ªå¾ˆé‡è¦ï¼ŒæŠŠéœ€è¦ç®¡ç†çš„ frameworks éƒ½å†™å‡ºæ¥ï¼Œå¦‚æœæœ‰ä¾èµ–å…³ç³»ï¼Œæœ€å¥½è¢«ä¾èµ–çš„å†™åœ¨å‰é¢
s.vendored_frameworks = &quot;SohuCoreFoundation.framework&quot;,&quot;SohuGameSDK.framework&quot;
///ä¸éœ€è¦é¢å¤–æš´éœ²å¤´æ–‡ä»¶
# s.source_files  = &quot;**/*.{h}&quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h1 id=&quot;éªŒè¯-podspec-æ–‡ä»¶&quot;&gt;éªŒè¯ podspec æ–‡ä»¶&lt;/h1&gt;

&lt;p&gt;åŒæ ·çš„ï¼Œä½¿ç”¨ &lt;code class=&quot;highlighter-rouge&quot;&gt;pod spec lint --allow-warnings&lt;/code&gt; éªŒè¯ä¸‹ï¼Œé€šè¿‡å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;-&amp;gt; TestSCFPods (1.0.0)

Analyzed 1 podspec.

TestSCFPods.podspec passed validation.
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;æœ‰é”™è¯¯çš„è¯ï¼Œå°±ä½¿ç”¨ &lt;code class=&quot;highlighter-rouge&quot;&gt;pod spec lint --allow-warnings --verbose&lt;/code&gt; å†æ¬¡éªŒè¯ï¼Œä¸è¿‡ä¼šæ‰“å°è¯¦ç»†çš„æ—¥å¿—ï¼Œé€šè¿‡æ—¥å¿—å»æ‰¾é—®é¢˜ï¼&lt;/p&gt;

&lt;h1 id=&quot;æäº¤-podspec-æ–‡ä»¶&quot;&gt;æäº¤ podspec æ–‡ä»¶&lt;/h1&gt;

&lt;p&gt;å¦‚æœæ²¡æœ‰è´¦æˆ·çš„è¯ï¼Œé‚£å°±æ³¨å†Œä¸€ä¸ªï¼›æ³¨å†Œè¿‡äº†å°± push å§ï¼š&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;pod trunk push TestSCFPods.podspec --allow-warnings&lt;/code&gt;&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Updating spec repo `master`

CocoaPods 1.3.0.beta.3 is available.
To update use: `sudo gem install cocoapods --pre`
[!] This is a test version we'd love you to try.

For more information, see https://blog.cocoapods.org and the CHANGELOG for this version at https://github.com/CocoaPods/CocoaPods/releases/tag/1.3.0.beta.3

Validating podspec
 -&amp;gt; TestSCFPods (1.0.0)

Updating spec repo `master`

CocoaPods 1.3.0.beta.3 is available.
To update use: `sudo gem install cocoapods --pre`
[!] This is a test version we'd love you to try.

For more information, see https://blog.cocoapods.org and the CHANGELOG for this version at https://github.com/CocoaPods/CocoaPods/releases/tag/1.3.0.beta.3


--------------------------------------------------------------------------------
 ğŸ‰  Congrats

 ğŸš€  TestSCFPods (1.0.0) successfully published
 ğŸ“…  July 20th, 07:25
 ğŸŒ  https://cocoapods.org/pods/TestSCFPods
 ğŸ‘  Tell your friends!
--------------------------------------------------------------------------------
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;æ­å–œä½ ï¼ŒæˆåŠŸäº†ï¼Œæ¥ä¸‹æ¥å°±å¯ä»¥åˆ›å»ºä¸ª demo è¯•ä¸‹äº†ï¼&lt;/p&gt;

&lt;p&gt;ä¸ä»…èƒ½ç®¡ç† frameworks ï¼Œè¿˜å¯ä»¥ç®¡ç† .a é™æ€åº“ï¼ŒåŒºåˆ«æ˜¯ &lt;strong&gt;s.vendored_frameworks&lt;/strong&gt; æ”¹ä¸º &lt;strong&gt;s.vendored_libraries&lt;/strong&gt; !&lt;/p&gt;

&lt;p&gt;æˆ‘è§‰å¾—å¾ˆèµçš„æ˜¯ï¼Œä¸ç”¨å°†èµ„æºæ‰‹åŠ¨æ·»åŠ åˆ°ä¸»å·¥ç¨‹é‡Œå»ï¼Œpodsä¼šè‡ªåŠ¨é€šè¿‡è„šæœ¬å¸®ä½ å®Œæˆè¿™ä»¶äº‹ï¼Œè¿™ä¸ªæ˜¯æ–°ç‰ˆ pods æ‰æœ‰çš„åŠŸèƒ½ï¼Œæœ€åˆæ˜¯ä¸æ”¯æŒçš„ï¼Œå¤§æ¦‚æ˜¯ä» 1.0 å¼€å§‹æ”¯æŒçš„ï¼ï¼&lt;/p&gt;

&lt;h1 id=&quot;å®é™…æ•ˆæœ&quot;&gt;å®é™…æ•ˆæœ&lt;/h1&gt;

&lt;p&gt;ä½¿ç”¨ pods çš„æœ€åˆåŸå› æ˜¯ä¸ºäº†ï¼Œé›†æˆæˆ‘ SDK çš„å¼€å‘äººå‘˜èƒ½å¤Ÿç®€å•é«˜æ•ˆçš„æ¢åŒ…ï¼Œä»å®é™…ä½¿ç”¨çš„æ•ˆç‡ä¸Šæ¥çœ‹ï¼Œå…¶å®æ²¡æœ‰é‚£ä¹ˆç†æƒ³ï¼Œæˆ‘ä¸¾ä¸ªæ —å­ï¼Œæ¯”å¦‚æˆ‘ SDK è¦æ›´æ–°å‘åŒ…äº†ï¼š&lt;/p&gt;

&lt;p&gt;æˆ‘çš„å·¥ä½œæ˜¯:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;å°† SDKï¼ˆä¹Ÿå°±æ˜¯ç›¸å…³çš„ frameworksï¼‰ä¸Šä¼ åˆ° github&lt;/li&gt;
  &lt;li&gt;å‡çº§ä¸€ä¸ª tag å·&lt;/li&gt;
  &lt;li&gt;å‡çº§ podspec ç‰ˆæœ¬å·&lt;/li&gt;
  &lt;li&gt;å°† podspec æ¨é€åˆ° cocospods&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;é›†æˆè€…çš„å·¥ä½œæ˜¯:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;å‡çº§ Podfile çš„ç‰ˆæœ¬å·&lt;/li&gt;
  &lt;li&gt;ä½¿ç”¨ pod update æŠŠåº“æ›´æ–°ä¸‹æ¥&lt;/li&gt;
  &lt;li&gt;æäº¤æ›´æ–°åçš„ä»£ç &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;æ€»ä½“çœ‹æ¥ï¼ŒSDKæ›´æ–°ä¸€ä¸ªç‰ˆæœ¬ä¸€å…±éœ€è¦ 7 ä¸ªæ­¥éª¤ï¼Œæˆ‘æ„Ÿè§‰æ˜¯ç•¥ç¹çäº†äº›ï¼Œæ‰€ä»¥æˆ‘å¹¶æ²¡æœ‰é‡‡ç”¨ pods ç®¡ç† frameworks æ¥è‡ªåŠ¨æ¢åŒ…è¿™ä¸ªæ–¹æ¡ˆï¼&lt;/p&gt;

&lt;p&gt;è¿˜æœ‰ä¸ªå¼Šç«¯æ˜¯ï¼Œå¦‚æœ Podfile é‡Œæ²¡æœ‰æŒ‡å®šå°ç‰ˆæœ¬å·ï¼Œé‚£ä¹ˆå¯èƒ½é›†æˆAppä¾èµ–çš„å…¶ä»–åº“ä¹Ÿè¢«æ›´æ–°äº†ï¼Œæˆ–è®¸Appå¼€å‘å¹¶ä¸æƒ³æ›´æ–°å…¶ä»–ä¾èµ–åº“ï¼&lt;/p&gt;</content><author><name>è®¸ä¹¾éš†</name><email>qianlongxu@gmail.com</email></author><summary type="html">ä¸Šç¯‡åšå®¢ä»‹ç»äº†å¦‚ä½•åˆ›å»º pods åº“ï¼Œè®© pods åº“å¸®æˆ‘ä»¬ç®¡ç†æºç ã€ä¾èµ–ã€ç¼–è¯‘æˆåº“ã€é…ç½®search pathç­‰å·¥ä½œï¼›ä½†æœ‰æ—¶å€™ä½ å¯èƒ½ä¸æƒ³æˆ–è€…ä¸èƒ½æŠŠæºç æä¾›å‡ºå»ï¼Œè¿˜æƒ³è¦ä½¿ç”¨ pods ç®¡ç†ç‰ˆæœ¬çš„è¯ï¼Œå°±å¯ä»¥è®© pods ç›´æ¥ç®¡ç† frameworks è€Œä¸æ˜¯æºç ï¼</summary></entry><entry><title type="html">åˆ›å»º CocoaPods åº“</title><link href="http://localhost:4000/ios/cocoapods/2017/07/20/create-pod-library/" rel="alternate" type="text/html" title="åˆ›å»º CocoaPods åº“" /><published>2017-07-20T17:23:12+08:00</published><updated>2017-07-20T17:23:12+08:00</updated><id>http://localhost:4000/ios/cocoapods/2017/07/20/create-pod-library</id><content type="html" xml:base="http://localhost:4000/ios/cocoapods/2017/07/20/create-pod-library/">&lt;p&gt;ä½¿ç”¨ CocoaPods ç®¡ç† iOS åº“å·²ç»ä¸æ˜¯ä»€ä¹ˆæ–°é²œäº‹äº†ï¼Œæˆ‘æœ€è¿‘åˆšå¼€æºäº†ä¸€ä¸ªç½‘ç»œåº“ï¼Œä¸ºäº†æ–¹ä¾¿é›†æˆä½¿ç”¨ï¼Œå› æ­¤å†³å®šæ”¯æŒä¸‹ CocoaPodsï¼ŒæœŸé—´ä¹Ÿé‡åˆ°äº†å‡ ä¸ªé—®é¢˜ï¼Œåˆ†äº«ç»™å¤§å®¶ã€‚&lt;/p&gt;

&lt;h1 id=&quot;å‡†å¤‡å·¥ä½œ&quot;&gt;å‡†å¤‡å·¥ä½œ&lt;/h1&gt;

&lt;p&gt;åˆ›å»º Pods åº“ï¼Œå…¶å®æ„æ€æ˜¯è®©ä½ çš„å¼€æºåº“æ”¯æŒ CocoaPods ç®¡ç†ï¼Œå› æ­¤å‰ææ˜¯ä½ åº”å½“æœ‰ä¸€ä¸ªå¼€æºåº“ï¼Œå…ˆå‘å¸ƒåˆ° github ä¸Šï¼Œè®°å¾—åˆ›å»ºç©ºä»“åº“çš„æ—¶å€™è®© github ç»™ä½ ç”Ÿæˆä¸€ä¸ª licenseï¼Œæ–¹é¢ç­‰ä¼šå¡«å†™ Spec Licenseã€‚&lt;/p&gt;

&lt;p&gt;åœ¨åˆ›å»º Pods åº“ä¹‹å‰ï¼Œæˆ‘å·²ç»æŠŠ demo å’Œ SCNetworkKit åº“å‘å¸ƒåˆ° github ä¸Šäº†ï¼Œè¿™æ˜¯ç›®å½•ç»“æ„ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/201707/20-SCNetwork-folder.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;æ³¨æ„ï¼šå…¶å®åªéœ€è¦æŠŠåº“çš„æºç æ”¾è¿›æ¥å°±å¥½äº†ï¼Œç­‰åˆ›å»ºå®Œæ¯• pods åº“ä¹‹åï¼Œå†åˆ›å»º demo ï¼›ç”±äºæ”¯æŒ pods ä¹‹å‰æˆ‘å·²ç»æœ‰äº† demo äº†æ‰€ä»¥å°±æš‚æ—¶æ²¡åˆ é™¤ã€‚&lt;/p&gt;

&lt;p&gt;è®°å¾—åœ¨æœ€åä¸€æ¬¡æäº¤è®°å½•é‚£é‡Œæ·»åŠ ä¸€ä¸ª tagï¼Œå¹¶ push åˆ° github ä¸Šï¼Œè®°ä½è¿™ä¸ª tag å€¼ï¼Œä¸€ä¼šè¦ç”¨åˆ°ï¼&lt;/p&gt;

&lt;h1 id=&quot;åˆ›å»º-podspec&quot;&gt;åˆ›å»º podspec&lt;/h1&gt;

&lt;p&gt;é¦–å…ˆè¿›å…¥åˆ°ä»“åº“è·Ÿç›®å½•ï¼š&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;cd /Users/crown/gitworkspace/SCNetworkKit&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;æˆ‘ä»¬å°†åœ¨è¿™ä¸ªç›®å½•é‡Œåˆ›å»ºä¸€ä¸ª SCNetworkKit.podspec æ–‡ä»¶ï¼Œæ–‡ä»¶é‡Œé¢æ˜¯ä¸€äº›é…ç½®å’Œæè¿°ä¿¡æ¯ï¼Œä½¿ç”¨å¦‚ä¸‹å‘½ä»¤åˆ›å»ºï¼š&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;pod spec create SCNetworkKit&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;çœ‹åˆ°æç¤º &lt;code class=&quot;highlighter-rouge&quot;&gt;Specification created at SCNetworkKit.podspec&lt;/code&gt; å°±è¡¨æ˜åˆ›å»ºå¥½äº†ï¼æ¥ä¸‹æ¥æˆ‘ä»¬ä¿®æ”¹è¿™ä¸ªæ–‡ä»¶ï¼Œå¿…è¦çš„é…ç½®æ”¹ä¸‹å°±å¥½äº†ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;s.name : é»˜è®¤å·²ç»å¸®ä½ å†™å¥½äº†ï¼Œä¸ç”¨æ”¹äº†ï¼Œè¿™ä¸ªåå­—å°±æ˜¯åˆ«äºº pod ä½ çš„åº“çš„åå­—ï¼›&lt;/li&gt;
  &lt;li&gt;s.version : è¿™ä¸ª version å’Œä½  github ä»“åº“çš„tagæ˜¯å¯¹åº”çš„ï¼Œæ¯”å¦‚æˆ‘çš„tag æ˜¯ 1.0.0ï¼›&lt;/li&gt;
  &lt;li&gt;s.summary : å¯¹è¿™ä¸ªåº“çš„ä¸€ä¸ªç®€å•æè¿°ï¼Œä¸å†™çš„è¯ç­‰ä¼šéªŒè¯çš„æ—¶å€™ä¼šæœ‰è­¦å‘Šï¼Œåˆ«äººæœç´¢è¿™ä¸ªåº“çš„æ—¶å€™ä¹Ÿä¼šæ˜¾ç¤ºå‡ºæ¥ï¼Œæ‰€ä»¥æœ€å¥½å†™ä¸‹ï¼›&lt;/li&gt;
  &lt;li&gt;s.description : è¿™ä¸ªæ˜¯ä¸ªè¯¦ç»†çš„æè¿°ï¼Œæ–‡å­—ä¸ªæ•°è¦æ¯” summary å†™å¾—è¦å¤šï¼Œå¦åˆ™ä¹Ÿæœ‰è­¦å‘Šï¼›æ³¨æ„å†™åˆ°ä¸¤ä¸ª DESC ä¹‹é—´å°±å¥½äº†ï¼›&lt;/li&gt;
  &lt;li&gt;s.homepage : å¦‚æœè¿™ä¸ªåº“æœ‰ä¸»é¡µçš„è¯ï¼Œå¯ä»¥å¡«ä¸Šï¼Œæœç´¢è¿™ä¸ªåº“çš„æ—¶å€™ä¹Ÿä¼šæ˜¾ç¤ºå‡ºæ¥çš„ï¼›&lt;/li&gt;
  &lt;li&gt;s.license : æ”¹ä¸ºä½ å®é™…ä½¿ç”¨çš„ license å³å¯ï¼Œå¦‚æœæ²¡æœ‰çš„è¯ï¼Œé‚£å°±åˆ›å»ºä¸€ä¸ªè¡¥ä¸Šï¼›&lt;/li&gt;
  &lt;li&gt;s.author : ä½œè€…ï¼Œä¼šå¸®ä½ å¡«å†™ä¸º git çš„å…¨å±€è´¦æˆ·ï¼›&lt;/li&gt;
  &lt;li&gt;s.platform : æ ¹æ®å®é™…æƒ…å†µå†™ iOS æˆ–è€… OS Xï¼›&lt;/li&gt;
  &lt;li&gt;s.source : å¡«ä¸Šä»“åº“åœ°å€ï¼Œéœ€è¦httpså“¦ï¼Œæˆ–è€…å†™ ssh çš„ä¹Ÿè¡Œï¼›&lt;/li&gt;
  &lt;li&gt;s.source_files : åº“æ–‡ä»¶æ‰€åœ¨ç›®å½•ï¼Œå¯ä»¥é€’å½’ï¼›&lt;/li&gt;
  &lt;li&gt;s.framework : ä¾èµ–çš„ç³»ç»Ÿåº“ï¼›&lt;/li&gt;
  &lt;li&gt;s.library : ä¾èµ–çš„ç³»ç»Ÿåº“ï¼›&lt;/li&gt;
  &lt;li&gt;s.requires_arc : æ˜¯å¦å¿…é¡»æ˜¯ arcï¼›&lt;/li&gt;
  &lt;li&gt;s.dependency : ä½ è¿™ä¸ªåº“ä¾èµ–äº†å“ªäº›å…¶ä»– pods åº“ï¼›&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ç¬¬ä¸€æ¬¡å¯èƒ½å†™ä¸å¥½ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥ä¸‹è½½ä¸€ä¸ªï¼Œçœ‹ç€æ”¹ã€‚&lt;/p&gt;

&lt;p&gt;å†™å¥½äº†ï¼Œå°±éªŒè¯ä¸‹æ–‡ä»¶æ˜¯å¦æœ‰è¯¯ï¼Œå¯èƒ½éœ€è¦å¤šæ¬¡ä¿®æ”¹ï¼Œå¤šæ¬¡éªŒè¯ï¼š&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;pod spec lint --allow-warnings&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;æˆ‘é‡åˆ°çš„é”™è¯¯ï¼š&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;-&amp;gt; SCNetworkKit (1.0.0)
    - ERROR | [iOS] xcodebuild: Returned an unsuccessful exit code. You can use `--verbose` for more information.
    - NOTE  | xcodebuild:  Headers/Public/SCNetworkKit/SCNetworkKit.h:11:9: fatal error: 'NSDictionary+SCAddtions.h' file not found
    - NOTE  | xcodebuild:  clang: error: linker command failed with exit code 1 (use -v to see invocation)
    - NOTE  | [iOS] xcodebuild:  fatal error: /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/lipo: can't open input file: /var/folders/2z/l7ftfgd54lv0_nvq7pnr_zbw0000gn/T/CocoaPods/Lint/DerivedData/App/Build/Intermediates/App.build/Release-iphonesimulator/App.build/Objects-normal/i386/App (No such file or directory)
    - NOTE  | [iOS] xcodebuild:  error: cannot parse the debug map for &quot;/var/folders/2z/l7ftfgd54lv0_nvq7pnr_zbw0000gn/T/CocoaPods/Lint/DerivedData/App/Build/Products/Release-iphonesimulator/App.app/App&quot;: No such file or directory
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;è¿™ä¸ªåŸå› æ˜¯æˆ‘æœ€åˆè·¯å¾„æˆ‘å†™é”™äº†ï¼Œå†™æˆäº† &lt;code class=&quot;highlighter-rouge&quot;&gt;s.source_files  = &quot;SCNetworkKit/*.{h,m}&quot;&lt;/code&gt;ï¼Œæ²¡æœ‰é€’å½’æŸ¥æ‰¾å­æ–‡ä»¶å¤¹é‡Œçš„ç±»ï¼Œæ‰€ä»¥è¯´è¿™ä¸ªç±»åˆ«æ–‡ä»¶æ‰¾ä¸åˆ°ï¼æˆ‘æ˜¯é€šè¿‡åŠ ä¸Š &lt;code class=&quot;highlighter-rouge&quot;&gt;--verbose&lt;/code&gt; ä¹‹åï¼ŒæŸ¥çœ‹æ‰§è¡Œè¿‡ç¨‹å‘ç°çš„ï¼ŒéªŒè¯çš„æ—¶å€™ä¼šä¸‹è½½æ–‡ä»¶ï¼Œç„¶å copy åˆ°åˆ«çš„ç›®å½•å»ç¼–è¯‘ï¼Œæˆ‘å‘ç°æ²¡æœ‰ä¸‹è½½å­æ–‡ä»¶é‡Œçš„æ–‡ä»¶ï¼&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;-&amp;gt; Installing SCNetworkKit (1.0.0)
  &amp;gt; Copying SCNetworkKit from
  `/Users/crown/Library/Caches/CocoaPods/Pods/External/SCNetworkKit/d91c7ff7dcd08eaf54117a932c0d41d7-b0517`
  to
  `../../../../private/var/folders/2z/l7ftfgd54lv0_nvq7pnr_zbw0000gn/T/CocoaPods/Lint/Pods/SCNetworkKit`
  - Running pre install hooks
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;è¿˜é‡åˆ°äº†è¿™ä¸ªé”™è¯¯ï¼š&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; -&amp;gt; SCNetworkKit (1.0.0)
    - ERROR | [iOS] xcodebuild: Returned an unsuccessful exit code. You can use `--verbose` for more information.
    - NOTE  | xcodebuild:  /var/folders/2z/l7ftfgd54lv0_nvq7pnr_zbw0000gn/T/CocoaPods/Lint/DerivedData/App/Build/Products/Release-iphonesimulator/SCNetworkKit/SCNetworkKit.framework/Headers/SCNetworkKit.h:14:9: fatal error: 'SCJSONUtil.h' file not found
    - NOTE  | xcodebuild:  /var/folders/2z/l7ftfgd54lv0_nvq7pnr_zbw0000gn/T/CocoaPods/Lint/App/main.m:3:9: fatal error: could not build module 'SCNetworkKit'
    - NOTE  | xcodebuild:  clang: error: linker command failed with exit code 1 (use -v to see invocation)
    - NOTE  | [iOS] xcodebuild:  fatal error: /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/lipo: can't open input file: /var/folders/2z/l7ftfgd54lv0_nvq7pnr_zbw0000gn/T/CocoaPods/Lint/DerivedData/App/Build/Intermediates/App.build/Release-iphonesimulator/App.build/Objects-normal/i386/App (No such file or directory)
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;åŸå› æ˜¯ demo é‡Œæœ‰ä¸ª SCJSONUtil.h æ–‡ä»¶ï¼Œæˆ‘ä¸å°å¿ƒæŠŠä»–å¯¼å…¥åˆ° SCNetworkKit.h é‡Œäº†ï¼Œä½†æ˜¯ pods æ£€æŸ¥æ˜¯ä¸ä¼šå»ä¸‹è½½ demoï¼Œæ‰€ä»¥æ ¹æœ¬æ‰¾ä¸åˆ°è¿™ä¸ª SCJSONUtil.h è¿™ä¸ªå¤´æ–‡ä»¶ï¼ï¼ï¼äºæ˜¯æˆ‘åˆ äº†è¿™ä¸ªå¤´æ–‡ä»¶ï¼Œæ¥ç€ push åˆ°äº† githubï¼Œå¹¶ä¸”ä¿®æ”¹äº† tag å·ï¼ å†æ¬¡æ£€æŸ¥åå‘ç°è¿˜æ˜¯è¿™ä¸ªé”™è¯¯ï¼Œè¯•äº†å‡ æ¬¡éƒ½æ˜¯ï¼Œæˆ‘è§‰å¾—ä¸å¯¹åŠ²ï¼Œæ˜¯ä¸æ˜¯èµ°äº†ç¼“å­˜äº†ï¼Ÿæ²¿ç€è¿™ä¸ªæ€è·¯å»æ£€æŸ¥ï¼Œå‘ç°æœçœŸä¸æ˜¯æ¯æ¬¡æ£€æŸ¥éƒ½ä¼šé‡æ–°ä¸‹è½½ä»£ç çš„ï¼Œè€Œæ˜¯è¯»äº†ç¼“å­˜äº†ï¼ï¼ï¼å› æ­¤æˆ‘åˆ æ‰äº†ç¼“å­˜çš„ä»£ç ï¼Œå†æ¬¡éªŒè¯å°±é€šè¿‡äº†ï¼ åˆ é™¤ä¹‹åï¼Œå‘ç°åœ¨ Copy ä¹‹å‰ä¼šé‡æ–°ä¸‹è½½ï¼&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Downloading dependencies

-&amp;gt; Installing SCNetworkKit (1.0.0)
 &amp;gt; Git download
 &amp;gt; Git download
     $ /usr/bin/git clone https://github.com/debugly/SCNetworkKit.git
     /var/folders/2z/l7ftfgd54lv0_nvq7pnr_zbw0000gn/T/d20170720-43460-137oplc
     --template= --single-branch --depth 1 --branch 1.0.0
     Cloning into '/var/folders/2z/l7ftfgd54lv0_nvq7pnr_zbw0000gn/T/d20170720-43460-137oplc'...
     Note: checking out '733b52034ca83c8ced0fb709e40bec8e3ccde344'.
     
     You are in 'detached HEAD' state. You can look around, make experimental
     changes and commit them, and you can discard any commits you make in this
     state without impacting any branches by performing another checkout.
     
     If you want to create a new branch to retain commits you create, you may
     do so (now or later) by using -b with the checkout command again. Example:
     
       git checkout -b &amp;lt;new-branch-name&amp;gt;
&amp;gt; Copying SCNetworkKit from
  `/Users/crown/Library/Caches/CocoaPods/Pods/External/SCNetworkKit/d91c7ff7dcd08eaf54117a932c0d41d7-2e598`
  to
  `../../../../private/var/folders/2z/l7ftfgd54lv0_nvq7pnr_zbw0000gn/T/CocoaPods/Lint/Pods/SCNetworkKit`
  - Running pre install hooks
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;è¿™ä¸ªè¿‡ç¨‹å¯èƒ½ä¼šé‡åˆ°å„ç§é”™è¯¯ï¼Œåªè¦è€å¿ƒçœ‹æ‰“å°çš„æ—¥å¿—ï¼Œä¸€èˆ¬éƒ½èƒ½è§£å†³çš„ï¼Œå¯èƒ½éœ€è¦åå¤éªŒè¯ï¼Œéœ€è¦æœ‰äº›è€å¿ƒï¼&lt;/p&gt;

&lt;p&gt;é€šè¿‡åä¼šæ‰“å°:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;** BUILD SUCCEEDED **

 -&amp;gt; SCNetworkKit (1.0.0)

Analyzed 1 podspec.

SCNetworkKit.podspec passed validation.
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h1 id=&quot;åˆ›å»ºè´¦æˆ·&quot;&gt;åˆ›å»ºè´¦æˆ·&lt;/h1&gt;

&lt;p&gt;å‘å¸ƒä¹‹å‰éœ€è¦åˆ›å»ºä¸€ä¸ª CocoaPods çš„è´¦æˆ·ï¼Œå¦‚æœä½ æœ‰å¤šä¸ªç”µè„‘ï¼Œé‚£ä¹ˆä½ å¯ä»¥æ³¨å†Œå¤šæ¬¡ï¼Œä»¥é‚®ç®±åœ°å€ä¸ºå”¯ä¸€æ ‡è¯†ï¼Œä¸€ä¸ªé‚®ç®±åœ°å€å¯ä»¥åœ¨å¤šå°ç”µè„‘ä¸Šæ³¨å†Œï¼&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;pod trunk register youar@email.com 'nickNameâ€™&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;é€šè¿‡è¿™ä¸ªå‘½ä»¤æ³¨å†Œåï¼Œä½ çš„é‚®ç®±å¾ˆå¿«å°±ä¼šæ”¶åˆ° CocoaPods å‘æ¥çš„éªŒè¯é“¾æ¥ï¼Œç‚¹å‡»å³å¯æ¿€æ´»ï¼Œåç§°æ— æ³•ä¿®æ”¹å“¦ï¼æ¿€æ´»ä¹‹åï¼Œæˆ‘ä»¬è¿”å›åˆ°ç»ˆç«¯ç»§ç»­å¾€ä¸‹æ“ä½œå³å¯ï¼Œä½¿ç”¨ &lt;code class=&quot;highlighter-rouge&quot;&gt;pod trunk me&lt;/code&gt; æŸ¥çœ‹ä¸ªäººä¿¡æ¯ï¼š&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;pod trunk me
  - Name:     Matt Reach
  - Email:    qianlongxu@gmail.com
  - Since:    July 20th, 02:05
  - Pods:
    - SCNetworkKit
  - Sessions:
    - July 20th, 02:05 - November 25th, 04:34. IP: 125.35.217.43
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h1 id=&quot;å‘å¸ƒ-podspec&quot;&gt;å‘å¸ƒ podspec&lt;/h1&gt;

&lt;p&gt;å°†åˆšæ‰å·²ç»éªŒè¯é€šè¿‡çš„ podspec push åˆ° cocoapods çš„ä»“åº“é‡Œï¼Œè¿™æ ·åˆ«äººå°±èƒ½é€šè¿‡ pods æœç´¢åˆ°ä½ çš„åº“äº†ï¼Œä»è€Œä½¿ç”¨ä½ çš„åº“äº†ï¼›&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;pod trunk push SCNetworkKit.podspec 
Updating spec repo `master`

CocoaPods 1.3.0.beta.2 is available.
To update use: `sudo gem install cocoapods --pre`
[!] This is a test version we'd love you to try.

For more information, see https://blog.cocoapods.org and the CHANGELOG for this version at https://github.com/CocoaPods/CocoaPods/releases/tag/1.3.0.beta.2

Validating podspec
 -&amp;gt; SCNetworkKit (1.0.0)

Updating spec repo `master`

CocoaPods 1.3.0.beta.2 is available.
To update use: `sudo gem install cocoapods --pre`
[!] This is a test version we'd love you to try.

For more information, see https://blog.cocoapods.org and the CHANGELOG for this version at https://github.com/CocoaPods/CocoaPods/releases/tag/1.3.0.beta.2


--------------------------------------------------------------------------------
 ğŸ‰  Congrats

 ğŸš€  SCNetworkKit (1.0.0) successfully published
 ğŸ“…  July 20th, 02:58
 ğŸŒ  https://cocoapods.org/pods/SCNetworkKit
 ğŸ‘  Tell your friends!
--------------------------------------------------------------------------------
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;çœ‹åˆ°è¿™ä¸ªå°±è¡¨æ˜å·²ç» push æˆåŠŸäº†ï¼ï¼&lt;/p&gt;

&lt;h1 id=&quot;æœç´¢&quot;&gt;ğŸ”æœç´¢&lt;/h1&gt;

&lt;p&gt;æ˜¯ä¸æ˜¯å¾ˆé«˜å…´å‘¢ï¼ŒPods åº“åˆ›å»ºå¥½äº†ï¼Œæˆ‘ä»¬è¯•ç€æœä¸‹å§ï¼š&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;pod search SCNetworkKit&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;ç»“æœæ˜¯ï¼š&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;[!] Unable to find a pod with name, author, summary, or description matching `SCNetworkKit`
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;å¥½éƒé—·å‘¢ï¼Œæ˜æ˜å·²ç»æˆåŠŸå‘å¸ƒäº†ï¼Œä¸ºä½•å°±æ˜¯æœç´¢ä¸åˆ°å‘¢ï¼Ÿè¿™æ˜¯å› ä¸ºå†æ¬¡ä¹‹å‰æˆ‘æœè¿‡åˆ«çš„åº“ï¼ŒCocoaPods åšäº†ç¼“å­˜äº†ï¼Œå› æ­¤æˆ‘ä»¬æ‰¾åˆ°ä»–çš„æœç´¢ç´¢å¼•ç¼“å­˜ï¼Œå°†å®ƒåˆ é™¤å³å¯ï¼š&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;rm -rf ~/Library/Caches/CocoaPods&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;å†æ¬¡æœç´¢ï¼Œä¼šé‡æ–°å»ºç«‹ç´¢å¼•ï¼Œè¿™ä¸ªè¿‡ç¨‹å¤§æ¦‚éœ€è¦ç‰‡åˆ»ï¼Œè€å¿ƒç­‰å¾…å³å¯:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;pod search SCNetworkKit
Creating search index for spec repo 'macdownapp'.. Done!
Creating search index for spec repo 'master'.. Done!

-&amp;gt; SCNetworkKit (1.0.0)
   SCNetworkKit is a simple but powerful iOS network framework.
   pod 'SCNetworkKit', '~&amp;gt; 1.0.0'
   - Homepage: http://debugly.cn/SCNetworkKit/
   - Source:   https://github.com/debugly/SCNetworkKit.git
   - Versions: 1.0.0 [master repo]
(END)
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h1 id=&quot;åˆ›å»º-demo&quot;&gt;åˆ›å»º demo&lt;/h1&gt;

&lt;p&gt;ä¸ºäº†æ–¹ä¾¿åˆ«äººä½¿ç”¨ï¼Œå¿«é€Ÿä¸Šæ‰‹ï¼Œæœ€å¥½åˆ›å»ºä¸€ä¸ª demoï¼Œå’Œåº“æ”¾åœ¨åŒä¸€ä¸ªä»“åº“å°±å¯ä»¥äº†.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;é¦–å…ˆåˆ›å»ºä¸€ä¸ªå¹²å‡€çš„å·¥ç¨‹ï¼Œç„¶åä¸ºä¹‹ç¼–å†™ Podfile :&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;platform :ios, '7.0'

target 'SCNDemo' do
    pod &quot;SCNetworkKit&quot;, '~&amp;gt;1.0.3'
    pod 'SCJSONUtil', '~&amp;gt;2.4.1'
end
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;æ¥ä¸‹æ¥ä½¿ç”¨ &lt;code class=&quot;highlighter-rouge&quot;&gt;pod update&lt;/code&gt; å®‰è£…podsåº“ï¼Œï¼ˆç”±äºæ˜¯æ–°åº“ï¼Œå¯èƒ½ä½¿ç”¨ &lt;code class=&quot;highlighter-rouge&quot;&gt;pod install&lt;/code&gt; ä¼šå¤±è´¥ï¼‰ï¼›&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;æœ€ååœ¨ demo é‡Œå†™å‡ ä¸ªè°ƒç”¨åº“çš„èŒƒä¾‹å°± OK äº†ï¼&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;å½“åˆ«äººä½¿ç”¨ pod try çš„æ—¶å€™ï¼Œå°±ä¼šæŠŠä½ è¿™ä¸ª demo ä¸‹è½½åˆ°ä¸€ä¸ªä¸´æ—¶ç›®å½•é‡Œï¼Œå¦‚æœä¸æä¾› demoï¼Œåˆ«äººå°±æ— æ³•ä½¿ç”¨ pod try å°è¯•ä½ çš„åº“ï¼&lt;/p&gt;

&lt;h1 id=&quot;æ›´æ–°-pods-åº“ç‰ˆæœ¬&quot;&gt;æ›´æ–° pods åº“ç‰ˆæœ¬&lt;/h1&gt;

&lt;p&gt;ä½ çš„å¼€æºåº“ä¼šè¶Šæ¥è¶Šç¨³å®šï¼ŒåŠŸèƒ½ä¹Ÿæ›´åŠ çš„å¼ºå¤§ï¼Œè¿™æ—¶å°±åº”è¯¥è€ƒè™‘å‡çº§ä¸‹ pods åº“çš„ç‰ˆæœ¬äº†ï¼Œåšæ³•å¾ˆç®€å•ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;é¦–å…ˆç»™ä»“åº“æ‰“ä¸ªæ–°çš„æ ‡ç­¾ï¼Œæ ‡ç­¾åå°±æ˜¯ pods åº“çš„ç‰ˆæœ¬å·ï¼Œæ¯”å¦‚æˆ‘çš„ç½‘ç»œåº“å‡çº§åˆ°äº† 1.0.1 äº†ï¼Œå°±æ‰“ä¸ª 1.0.1 çš„ tagï¼Œç„¶å push åˆ° github ;&lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;æŠŠ podspec æ–‡ä»¶é‡Œçš„ç‰ˆæœ¬å·ä¹Ÿæ›´æ–°ä¸º 1.0.1ï¼Œç„¶åæ¨é€åˆ° cocoapods ä»“åº“ :&lt;/p&gt;

    &lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  pod trunk push SCNetworkKit.podspec 
  Updating spec repo `master`
	
  CocoaPods 1.3.0.beta.3 is available.
  To update use: `sudo gem install cocoapods --pre`
  [!] This is a test version we'd love you to try.
	
  For more information, see https://blog.cocoapods.org and the CHANGELOG for this version at https://github.com/CocoaPods/CocoaPods/releases/tag/1.3.0.beta.3
	
  Validating podspec
   -&amp;gt; SCNetworkKit (1.0.1)
	
  Updating spec repo `master`
	
  CocoaPods 1.3.0.beta.3 is available.
  To update use: `sudo gem install cocoapods --pre`
  [!] This is a test version we'd love you to try.
	
  For more information, see https://blog.cocoapods.org and the CHANGELOG for this version at https://github.com/CocoaPods/CocoaPods/releases/tag/1.3.0.beta.3
	
	
  --------------------------------------------------------------------------------
   ğŸ‰  Congrats
	
   ğŸš€  SCNetworkKit (1.0.1) successfully published
   ğŸ“…  July 21st, 00:16
   ğŸŒ  https://cocoapods.org/pods/SCNetworkKit
   ğŸ‘  Tell your friends!
  --------------------------------------------------------------------------------
&lt;/code&gt;&lt;/pre&gt;
    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;æœ€åæŠŠ podspec æ–‡ä»¶çš„æ›´æ”¹æäº¤åˆ° github ä»“åº“ï¼Œä¸æä¹Ÿæ²¡æœ‰å…³ç³»ï¼Œåªæ˜¯ä¸ºäº†æ–¹ä¾¿ä¸‹æ¬¡ä¿®æ”¹è€Œå·²ï¼Œå› ä¸ºå·²ç» push åˆ° cocoapods ä»“åº“é‡Œäº†ï¼&lt;/li&gt;
&lt;/ul&gt;</content><author><name>è®¸ä¹¾éš†</name><email>qianlongxu@gmail.com</email></author><summary type="html">ä½¿ç”¨ CocoaPods ç®¡ç† iOS åº“å·²ç»ä¸æ˜¯ä»€ä¹ˆæ–°é²œäº‹äº†ï¼Œæˆ‘æœ€è¿‘åˆšå¼€æºäº†ä¸€ä¸ªç½‘ç»œåº“ï¼Œä¸ºäº†æ–¹ä¾¿é›†æˆä½¿ç”¨ï¼Œå› æ­¤å†³å®šæ”¯æŒä¸‹ CocoaPodsï¼ŒæœŸé—´ä¹Ÿé‡åˆ°äº†å‡ ä¸ªé—®é¢˜ï¼Œåˆ†äº«ç»™å¤§å®¶ã€‚</summary></entry><entry><title type="html">å®‰è£… CocoaPods</title><link href="http://localhost:4000/ios/cocoapods/2017/07/19/install-cocoapods/" rel="alternate" type="text/html" title="å®‰è£… CocoaPods" /><published>2017-07-19T10:32:12+08:00</published><updated>2017-07-19T10:32:12+08:00</updated><id>http://localhost:4000/ios/cocoapods/2017/07/19/install-cocoapods</id><content type="html" xml:base="http://localhost:4000/ios/cocoapods/2017/07/19/install-cocoapods/">&lt;blockquote&gt;
  &lt;p&gt;å‰é¢çš„åšå®¢é‡Œç®€å•çš„ä»‹ç»è¿‡ Rubyï¼Œæˆ‘ä»¬ä¹ŸçŸ¥é“äº†å¦‚ä½•å®‰è£… Ruby å†™çš„ç¨‹åºåº“ï¼Œä»Šå¤©è¦å®‰è£…çš„æ˜¯å¤§åé¼é¼çš„ &lt;strong&gt;CocoaPods&lt;/strong&gt; ï¼Œä»–ä¹Ÿæ˜¯ä½¿ç”¨ Ruby å†™çš„ï¼&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h1 id=&quot;install&quot;&gt;Install&lt;/h1&gt;

&lt;p&gt;å¦‚æœæ²¡æ¥è§¦è¿‡ ruby çš„è¯ï¼Œæœ€å¥½æ˜¯å…ˆæ¥çœ‹ä¸‹è¿™ç¯‡åšå®¢é‡Œçš„åè¯è§£é‡Š : &lt;a href=&quot;/script/2017/06/04/use-rake.html#1&quot;&gt;ä½¿ç”¨ Rake é‡å†™æ‰“åŒ…è„šæœ¬&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ä½¿ç”¨ gem å‘½ä»¤å®‰è£…å³å¯ ï¼š &lt;code class=&quot;highlighter-rouge&quot;&gt;sudo gem install cocoapods&lt;/code&gt; ï¼›å®‰è£…è¿‡ç¨‹ï¼š&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Password:
Fetching: i18n-0.8.6.gem (100%)
Successfully installed i18n-0.8.6
Fetching: thread_safe-0.3.6.gem (100%)
Successfully installed thread_safe-0.3.6
Fetching: tzinfo-1.2.3.gem (100%)
Successfully installed tzinfo-1.2.3
Fetching: activesupport-4.2.9.gem (100%)
Successfully installed activesupport-4.2.9
Fetching: nap-1.1.0.gem (100%)
Successfully installed nap-1.1.0
Fetching: fuzzy_match-2.0.4.gem (100%)
Successfully installed fuzzy_match-2.0.4
Fetching: cocoapods-core-1.2.1.gem (100%)
Successfully installed cocoapods-core-1.2.1
Fetching: claide-1.0.2.gem (100%)
Successfully installed claide-1.0.2
Fetching: cocoapods-deintegrate-1.0.1.gem (100%)
Successfully installed cocoapods-deintegrate-1.0.1
Fetching: cocoapods-downloader-1.1.3.gem (100%)
Successfully installed cocoapods-downloader-1.1.3
Fetching: cocoapods-plugins-1.0.0.gem (100%)
Successfully installed cocoapods-plugins-1.0.0
Fetching: cocoapods-search-1.0.0.gem (100%)
Successfully installed cocoapods-search-1.0.0
Fetching: cocoapods-stats-1.0.0.gem (100%)
Successfully installed cocoapods-stats-1.0.0
Fetching: netrc-0.7.8.gem (100%)
Successfully installed netrc-0.7.8
Fetching: cocoapods-trunk-1.2.0.gem (100%)
Successfully installed cocoapods-trunk-1.2.0
Fetching: cocoapods-try-1.1.0.gem (100%)
Successfully installed cocoapods-try-1.1.0
Fetching: molinillo-0.5.7.gem (100%)
Successfully installed molinillo-0.5.7
Fetching: CFPropertyList-2.3.5.gem (100%)
Successfully installed CFPropertyList-2.3.5
Fetching: colored2-3.1.2.gem (100%)
Successfully installed colored2-3.1.2
Fetching: nanaimo-0.2.3.gem (100%)
Successfully installed nanaimo-0.2.3
Fetching: xcodeproj-1.5.1.gem (100%)
Successfully installed xcodeproj-1.5.1
Fetching: escape-0.0.4.gem (100%)
Successfully installed escape-0.0.4
Fetching: fourflusher-2.0.1.gem (100%)
Successfully installed fourflusher-2.0.1
Fetching: gh_inspector-1.0.3.gem (100%)
Successfully installed gh_inspector-1.0.3
Fetching: ruby-macho-1.1.0.gem (100%)
Successfully installed ruby-macho-1.1.0
Fetching: cocoapods-1.2.1.gem (100%)
Successfully installed cocoapods-1.2.1
Parsing documentation for i18n-0.8.6
Installing ri documentation for i18n-0.8.6
Parsing documentation for thread_safe-0.3.6
Installing ri documentation for thread_safe-0.3.6
Parsing documentation for tzinfo-1.2.3
Installing ri documentation for tzinfo-1.2.3
Parsing documentation for activesupport-4.2.9
Installing ri documentation for activesupport-4.2.9
Parsing documentation for nap-1.1.0
Installing ri documentation for nap-1.1.0
Parsing documentation for fuzzy_match-2.0.4
Installing ri documentation for fuzzy_match-2.0.4
Parsing documentation for cocoapods-core-1.2.1
Installing ri documentation for cocoapods-core-1.2.1
Parsing documentation for claide-1.0.2
Installing ri documentation for claide-1.0.2
Parsing documentation for cocoapods-deintegrate-1.0.1
Installing ri documentation for cocoapods-deintegrate-1.0.1
Parsing documentation for cocoapods-downloader-1.1.3
Installing ri documentation for cocoapods-downloader-1.1.3
Parsing documentation for cocoapods-plugins-1.0.0
Installing ri documentation for cocoapods-plugins-1.0.0
Parsing documentation for cocoapods-search-1.0.0
Installing ri documentation for cocoapods-search-1.0.0
Parsing documentation for cocoapods-stats-1.0.0
Installing ri documentation for cocoapods-stats-1.0.0
Parsing documentation for netrc-0.7.8
Installing ri documentation for netrc-0.7.8
Parsing documentation for cocoapods-trunk-1.2.0
Installing ri documentation for cocoapods-trunk-1.2.0
Parsing documentation for cocoapods-try-1.1.0
Installing ri documentation for cocoapods-try-1.1.0
Parsing documentation for molinillo-0.5.7
Installing ri documentation for molinillo-0.5.7
Parsing documentation for CFPropertyList-2.3.5
Installing ri documentation for CFPropertyList-2.3.5
Parsing documentation for colored2-3.1.2
Installing ri documentation for colored2-3.1.2
Parsing documentation for nanaimo-0.2.3
Installing ri documentation for nanaimo-0.2.3
Parsing documentation for xcodeproj-1.5.1
Installing ri documentation for xcodeproj-1.5.1
Parsing documentation for escape-0.0.4
Installing ri documentation for escape-0.0.4
Parsing documentation for fourflusher-2.0.1
Installing ri documentation for fourflusher-2.0.1
Parsing documentation for gh_inspector-1.0.3
Installing ri documentation for gh_inspector-1.0.3
Parsing documentation for ruby-macho-1.1.0
Installing ri documentation for ruby-macho-1.1.0
Parsing documentation for cocoapods-1.2.1
Installing ri documentation for cocoapods-1.2.1
Done installing documentation for i18n, thread_safe, tzinfo, activesupport, nap, fuzzy_match, cocoapods-core, claide, cocoapods-deintegrate, cocoapods-downloader, cocoapods-plugins, cocoapods-search, cocoapods-stats, netrc, cocoapods-trunk, cocoapods-try, molinillo, CFPropertyList, colored2, nanaimo, xcodeproj, escape, fourflusher, gh_inspector, ruby-macho, cocoapods after 16 seconds
26 gems installed

&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;å¦‚é‡åˆ°é—®é¢˜ï¼Œå¾ˆèƒ½æ˜¯æºçš„é—®é¢˜ï¼Œå¯ä»¥å¼€å¯ VPN ï¼Œæˆ–è€…æ›¿æ¢ä¸ºä¸‹é¢çš„æºåœ°å€ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Ruby ç¤¾åŒºçš„ Gem æ‰˜ç®¡æœåŠ¡: RubyGems.org&lt;/li&gt;
  &lt;li&gt;RubyGems é•œåƒ gems.ruby-china.org&lt;/li&gt;
  &lt;li&gt;RubyGems é•œåƒ ruby.taobao.org&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;æŸ¥çœ‹å½“å‰æº ï¼š&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;gem sources -l
*** CURRENT SOURCES ***
https://rubygems.org/
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;å°†å®˜æ–¹ rubygems.org ä¿®æ”¹ä¸ºå›½å†…çš„ gems.ruby-china.org æºåœ°å€ ï¼š&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;gem sources --add https://gems.ruby-china.org/ --remove https://rubygems.org/
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;å®‰è£…å®Œæ¯•åæœ€å¥½æ˜¯ &lt;strong&gt;pod setup&lt;/strong&gt; ä¸‹ï¼Œä½œç”¨æ˜¯æŠŠ &lt;a href=&quot;https://github.com/CocoaPods/Specs.git&quot;&gt;CocoaPods ä»“åº“&lt;/a&gt; clone åˆ°æœ¬åœ°ã€‚&lt;/p&gt;

&lt;h1 id=&quot;try&quot;&gt;Try&lt;/h1&gt;

&lt;p&gt;å¯ä»¥å°è¯•ç©ä¸‹ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;ç‰ˆæœ¬ ï¼š pod â€“version&lt;/li&gt;
  &lt;li&gt;æœç´¢ ï¼š pod search SCNetworkKit&lt;/li&gt;
  &lt;li&gt;å°è¯•demo ï¼š pod try SCNetworkKit&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;æ›´å¤šå‘½ä»¤ ï¼š&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;+ cache         Manipulate the CocoaPods cache
+ deintegrate   Deintegrate CocoaPods from your project
+ env           Display pod environment
+ init          Generate a Podfile for the current directory
+ install       Install project dependencies according to versions from a
                Podfile.lock
+ ipc           Inter-process communication
+ lib           Develop pods
+ list          List pods
+ outdated      Show outdated project dependencies
+ plugins       Show available CocoaPods plugins
+ repo          Manage spec-repositories
+ search        Search for pods
+ setup         Setup the CocoaPods environment
+ spec          Manage pod specs
+ trunk         Interact with the CocoaPods API (e.g. publishing new specs)
+ try           Try a Pod!
+ update        Update outdated project dependencies and create new
                Podfile.lock
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;å¯é€‰å‚æ•° ï¼š&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;--silent        Show nothing
--version       Show the version of the tool
--verbose       Show more debugging information
--no-ansi       Show output without ANSI codes
--help          Show help banner of specified command
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;</content><author><name>è®¸ä¹¾éš†</name><email>qianlongxu@gmail.com</email></author><summary type="html">å‰é¢çš„åšå®¢é‡Œç®€å•çš„ä»‹ç»è¿‡ Rubyï¼Œæˆ‘ä»¬ä¹ŸçŸ¥é“äº†å¦‚ä½•å®‰è£… Ruby å†™çš„ç¨‹åºåº“ï¼Œä»Šå¤©è¦å®‰è£…çš„æ˜¯å¤§åé¼é¼çš„ CocoaPods ï¼Œä»–ä¹Ÿæ˜¯ä½¿ç”¨ Ruby å†™çš„ï¼</summary></entry><entry><title type="html">æºç åˆ†æ weak å¯¹è±¡è‡ªåŠ¨ç½®ç©ºåŸç†</title><link href="http://localhost:4000/ios/2017/07/18/objc-weak-obj-imp/" rel="alternate" type="text/html" title="æºç åˆ†æ weak å¯¹è±¡è‡ªåŠ¨ç½®ç©ºåŸç†" /><published>2017-07-18T07:40:28+08:00</published><updated>2017-07-18T07:40:28+08:00</updated><id>http://localhost:4000/ios/2017/07/18/objc-weak-obj-imp</id><content type="html" xml:base="http://localhost:4000/ios/2017/07/18/objc-weak-obj-imp/">&lt;blockquote&gt;
  &lt;p&gt;æˆ‘ä»¬éƒ½çŸ¥é“ weak ä¿®é¥°çš„å˜é‡ï¼Œåœ¨å¯¹è±¡é‡Šæ”¾åï¼Œä¼šè‡ªåŠ¨ç½®ä¸º nilï¼Œè¿™ä¸€æœºåˆ¶å‡å°‘äº†å¤§é‡çš„é‡æŒ‡é’ˆå´©æºƒï¼›æˆ‘ä»¬è¿˜çŸ¥é“åœ¨ dealloc é‡Œä¸è¦ weak ä¿®é¥° self å¯¹è±¡ï¼Œå¦åˆ™å½“å¯¹è±¡ dealloc æ—¶å°±ä¼šå´©æºƒæ‰ï¼›ä¸€èµ·çœ‹ä¸‹æºç å®ç°å§!&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;ä¸‹è½½æºç &quot;&gt;ä¸‹è½½æºç &lt;/h2&gt;

&lt;p&gt;è™½ç„¶ iOS ä¸æ˜¯å¼€æºçš„ï¼Œä½†æ˜¯ OBJC è¿™éƒ¨åˆ†ä»£ç æ˜¯ Opençš„ï¼Œä¸‹è½½åœ°å€ : &lt;a href=&quot;https://opensource.apple.com/tarballs/objc4/&quot;&gt;objc4-709.tar.gz&lt;/a&gt; ã€‚è¿™æ˜¯ç¬¬äºŒæ¬¡é˜…è¯» objc æºç ï¼Œç¬¬ä¸€æ¬¡æ˜¯åˆ†æå…³è”å¼•ç”¨å®ç°åŸç†æ—¶é˜…è¯»çš„ : &lt;a href=&quot;/ios/2016/03/06/Objc-Associations-Advanced.html#1&quot;&gt;æ·±å…¥ç†è§£å…³è”å¼•ç”¨&lt;/a&gt;;æˆ‘çŒœæµ‹ weak çš„å®ç°å’Œå…³è”å¯¹è±¡åº”è¯¥æ˜¯å¤§åŒå°å¼‚çš„ï¼Œæ€è·¯ä¸Šåº”è¯¥æ˜¯ç›¸åŒçš„ï¼Œåº”è¯¥ä¹Ÿæ˜¯åœ¨åˆ›å»ºåå­˜è¡¨ï¼Œdealloc æ—¶ç½®ç©ºï¼Œç„¶åä»è¡¨é‡Œç§»é™¤æ‰ã€‚&lt;/p&gt;

&lt;h2 id=&quot;æ³¨å†Œ-weak-å˜é‡&quot;&gt;æ³¨å†Œ weak å˜é‡&lt;/h2&gt;

&lt;p&gt;åˆå§‹åŒ–ä¸€ä¸ª weak æŒ‡é’ˆæ—¶ä¼šèµ° objc_initWeak å‡½æ•°:&lt;/p&gt;

&lt;div class=&quot;language-objc highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cm&quot;&gt;/** 
 * Initialize a fresh weak pointer to some object location. 
 * It would be used for code like: 
 *
 * (The nil case) 
 * __weak id weakPtr;
 * (The non-nil case) 
 * NSObject *o = ...;
 * __weak id weakPtr = o;
 * 
 * This function IS NOT thread-safe with respect to concurrent 
 * modifications to the weak variable. (Concurrent weak clear is safe.)
 *
 * @param location Address of __weak ptr. 
 * @param newObj Object ptr. 
 */&lt;/span&gt;
 
&lt;span class=&quot;n&quot;&gt;id&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;objc_initWeak&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;id&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;location&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;id&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;newObj&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;newObj&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;location&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;nil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;nil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;storeWeak&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DontHaveOld&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DoHaveNew&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DoCrashIfDeallocating&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;location&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;objc_object&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;newObj&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;å†…éƒ¨ä¼šèµ° objc_storeWeak æ–¹æ³•æ¥å­˜å‚¨ä½ å£°æ˜çš„ weak å˜é‡ :&lt;/p&gt;

&lt;div class=&quot;language-objc highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cm&quot;&gt;/** 
 * This function stores a new value into a __weak variable. It would
 * be used anywhere a __weak variable is the target of an assignment.
 * 
 * @param location The address of the weak pointer itself
 * @param newObj The new object this weak ptr should now point to
 * 
 * @return newObj
 */&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;id&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;objc_storeWeak&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;id&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;location&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;id&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;newObj&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;storeWeak&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DoHaveOld&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DoHaveNew&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DoCrashIfDeallocating&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;location&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;objc_object&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;newObj&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;å†…éƒ¨åˆ™è°ƒç”¨äº† storeWeak è¿™ä¸ªå‡½æ•°ï¼Œå…¶å®è¿™ä¸ªæ³¨é‡Šå·²ç»è¯´çš„å¾ˆæ˜ç™½äº†ï¼Œ&lt;strong&gt;å¦‚æœ CrashIfDeallocating æ˜¯ true çš„è¯ï¼Œå½“ newObj æ­£åœ¨ dealloc æˆ–è€… newObj ä¸æ”¯æŒ weak å°±ä¼šå´©æºƒï¼&lt;/strong&gt;è°ƒç”¨çš„æ—¶å€™ä¼ çš„æ˜¯æšä¸¾å€¼ DoCrashIfDeallocatingï¼Œæ­£æ˜¯ true ï¼æ‰€ä»¥ä¸Šä¸€ç¯‡åšå®¢é‡Œæåˆ°çš„åœ¨ dealloc é‡Œä½¿ç”¨ weak self ä¼šå´©æºƒï¼Œç«‹å³ &lt;a href=&quot;/ios/2017/07/17/weakself-in-dealloc-cause-crash.html&quot;&gt;ä¼ é€&lt;/a&gt; ï¼&lt;/p&gt;

&lt;div class=&quot;language-objc highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// Update a weak variable.
// If HaveOld is true, the variable has an existing value 
//   that needs to be cleaned up. This value might be nil.
// If HaveNew is true, there is a new value that needs to be 
//   assigned into the variable. This value might be nil.
// If CrashIfDeallocating is true, the process is halted if newObj is 
//   deallocating or newObj's class does not support weak references. 
//   If CrashIfDeallocating is false, nil is stored instead.
&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;enum&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;CrashIfDeallocating&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;DontCrashIfDeallocating&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DoCrashIfDeallocating&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;true&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;template&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;HaveOld&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;haveOld&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;HaveNew&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;haveNew&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;CrashIfDeallocating&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;crashIfDeallocating&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;
          
&lt;span class=&quot;k&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;id&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;storeWeak&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;id&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;location&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;objc_object&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;newObj&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;assert&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;haveOld&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;haveNew&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;haveNew&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;assert&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;newObj&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;nil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;Class&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;previouslyInitializedClass&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;nil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;id&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;oldObj&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;SideTable&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;oldTable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;SideTable&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;newTable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;// Acquire locks for old and new values.
&lt;/span&gt;    &lt;span class=&quot;c1&quot;&gt;// Order by lock address to prevent lock ordering problems. 
&lt;/span&gt;    &lt;span class=&quot;c1&quot;&gt;// Retry if the old value changes underneath us.
&lt;/span&gt; &lt;span class=&quot;nl&quot;&gt;retry:&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;haveOld&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;oldObj&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;location&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;oldTable&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SideTables&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()[&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;oldObj&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;oldTable&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;nil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;haveNew&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;newTable&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SideTables&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()[&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;newObj&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;newTable&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;nil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;SideTable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lockTwo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;haveOld&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;haveNew&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;oldTable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;newTable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;haveOld&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;location&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;oldObj&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;SideTable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;unlockTwo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;haveOld&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;haveNew&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;oldTable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;newTable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;goto&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;retry&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;// Prevent a deadlock between the weak reference machinery
&lt;/span&gt;    &lt;span class=&quot;c1&quot;&gt;// and the +initialize machinery by ensuring that no 
&lt;/span&gt;    &lt;span class=&quot;c1&quot;&gt;// weakly-referenced object has an un-+initialized isa.
&lt;/span&gt;    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;haveNew&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;newObj&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;Class&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cls&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;newObj&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getIsa&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cls&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;previouslyInitializedClass&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt;  
            &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;objc_class&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cls&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;isInitialized&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt; 
        &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;SideTable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;unlockTwo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;haveOld&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;haveNew&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;oldTable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;newTable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;_class_initialize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_class_getNonMetaClass&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cls&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;newObj&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;

            &lt;span class=&quot;c1&quot;&gt;// If this class is finished with +initialize then we're good.
&lt;/span&gt;            &lt;span class=&quot;c1&quot;&gt;// If this class is still running +initialize on this thread 
&lt;/span&gt;            &lt;span class=&quot;c1&quot;&gt;// (i.e. +initialize called storeWeak on an instance of itself)
&lt;/span&gt;            &lt;span class=&quot;c1&quot;&gt;// then we may proceed but it will appear initializing and 
&lt;/span&gt;            &lt;span class=&quot;c1&quot;&gt;// not yet initialized to the check above.
&lt;/span&gt;            &lt;span class=&quot;c1&quot;&gt;// Instead set previouslyInitializedClass to recognize it on retry.
&lt;/span&gt;            &lt;span class=&quot;n&quot;&gt;previouslyInitializedClass&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cls&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

            &lt;span class=&quot;k&quot;&gt;goto&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;retry&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;// Clean up old value, if any.
&lt;/span&gt;    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;haveOld&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;weak_unregister_no_lock&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;oldTable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;weak_table&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;oldObj&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;location&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;// Assign new value, if any.
&lt;/span&gt;    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;haveNew&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;newObj&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;objc_object&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;weak_register_no_lock&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;newTable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;weak_table&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;newObj&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;location&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                                  &lt;span class=&quot;n&quot;&gt;crashIfDeallocating&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;// weak_register_no_lock returns nil if weak store should be rejected
&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;// Set is-weakly-referenced bit in refcount table.
&lt;/span&gt;        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;newObj&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;newObj&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;isTaggedPointer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;newObj&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;setWeaklyReferenced_nolock&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;// Do not set *location anywhere else. That would introduce a race.
&lt;/span&gt;        &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;location&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;newObj&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;// No new value. The storage is not changed.
&lt;/span&gt;    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;SideTable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;unlockTwo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;haveOld&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;haveNew&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;oldTable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;newTable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;newObj&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;å†…éƒ¨è°ƒç”¨ weak_register_no_lock æ³¨å†Œä¸€ä¸ª weakæŒ‡é’ˆå’Œå¯¹è±¡çš„é”®å€¼å¯¹ï¼Œç„¶åè¿”å›ï¼›å¦‚æœæ³¨å†Œçš„æ—¶å€™å‘ç°è¯¥å¯¹è±¡æ­£åœ¨ dealloc åˆ™ä¼šå´©æºƒï¼Œå¹¶ä¸”é€šè¿‡ _objc_fatal æ–¹æ³•ç•™äº†é—è¨€ï¼ï¼&lt;/p&gt;

&lt;div class=&quot;language-objc highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cm&quot;&gt;/** 
 * Registers a new (object, weak pointer) pair. Creates a new weak
 * object entry if it does not exist.
 * 
 * @param weak_table The global weak table.
 * @param referent The object pointed to by the weak reference.
 * @param referrer The weak pointer address.
 */&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;id&lt;/span&gt; 
&lt;span class=&quot;nf&quot;&gt;weak_register_no_lock&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;weak_table_t&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;weak_table&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;id&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;referent_id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                      &lt;span class=&quot;n&quot;&gt;id&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;referrer_id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;crashIfDeallocating&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;objc_object&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;referent&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;objc_object&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;referent_id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;objc_object&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;referrer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;objc_object&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;referrer_id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;referent&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;referent&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;isTaggedPointer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;referent_id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;// ensure that the referenced object is viable
&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;deallocating&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;referent&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ISA&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hasCustomRR&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;deallocating&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;referent&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rootIsDeallocating&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;BOOL&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;allowsWeakReference&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;objc_object&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SEL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 
            &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;BOOL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;objc_object&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SEL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;object_getMethodImplementation&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;referent&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                                           &lt;span class=&quot;n&quot;&gt;SEL_allowsWeakReference&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;IMP&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;allowsWeakReference&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_objc_msgForward&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;nil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;deallocating&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;allowsWeakReference&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;referent&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SEL_allowsWeakReference&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;deallocating&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;crashIfDeallocating&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;_objc_fatal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Cannot form weak reference to instance (%p) of &quot;&lt;/span&gt;
                        &lt;span class=&quot;s&quot;&gt;&quot;class %s. It is possible that this object was &quot;&lt;/span&gt;
                        &lt;span class=&quot;s&quot;&gt;&quot;over-released, or is in the process of deallocation.&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                        &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;referent&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;object_getClassName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;referent&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;nil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;// now remember it and where it is being stored
&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;weak_entry_t&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;entry&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;entry&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;weak_entry_for_referent&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;weak_table&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;referent&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;append_referrer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;entry&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;referrer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; 
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;weak_entry_t&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;new_entry&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;referent&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;referrer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;weak_grow_maybe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;weak_table&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;weak_entry_insert&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;weak_table&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;new_entry&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;// Do not set *referrer. objc_storeWeak() requires that the 
&lt;/span&gt;    &lt;span class=&quot;c1&quot;&gt;// value not change.
&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;referent_id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;è¿™é‡Œåªèƒ½çŒœæµ‹ runtime æ˜¯é€šè¿‡å¼•ç”¨è®¡æ•°æ˜¯å¦ä¸º 0 æ¥åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æ˜¯å¦æ˜¯å¤„äº deallocing çŠ¶æ€çš„ï¼Œå› ä¸º SEL_allowsWeakReference è¿™ä¸ªå‡½æ•°çš„å®šä¹‰æ˜¯æ‰¾ä¸åˆ°çš„ï¼ä½†æ˜¯æˆ‘ä»¬ä»æºç ä¸Šå¯ä»¥ç¡®åˆ‡çš„äº†è§£åˆ°ï¼Œå¦‚æœå¯¹è±¡æ­£åœ¨ deallocing ä¸èƒ½è®©ä»–ä½¿ç”¨ weak ä¿®é¥°ï¼å¦è€…å°±å´©æºƒæ‰äº†ï¼ï¼&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;if (deallocating) {
    if (crashIfDeallocating) {
        _objc_fatal(&quot;Cannot form weak reference to instance (%p) of &quot;
                    &quot;class %s. It is possible that this object was &quot;
                    &quot;over-released, or is in the process of deallocation.&quot;,
                    (void*)referent, object_getClassName((id)referent));
    } else {
        return nil;
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;objc é‡Œå°è£…äº† _objc_fatal è¿™ä¸ªå‡½æ•°ç”¨äºåœæ­¢ç¨‹åºï¼Œå¹¶ä¸”æä¸ªé—è¨€ï¼Œå†…éƒ¨åˆ™æ˜¯è°ƒç”¨äº† _objc_fatalv&lt;/p&gt;

&lt;div class=&quot;language-objc highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;_objc_fatal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fmt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;...)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;va_list&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ap&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; 
    &lt;span class=&quot;n&quot;&gt;va_start&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ap&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fmt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; 
    &lt;span class=&quot;n&quot;&gt;_objc_fatalv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;OBJC_EXIT_REASON_UNSPECIFIED&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                 &lt;span class=&quot;n&quot;&gt;OS_REASON_FLAG_ONE_TIME_FAILURE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                 &lt;span class=&quot;n&quot;&gt;fmt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ap&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;_objc_fatalv å±äºå†…éƒ¨ç§æœ‰æ–¹æ³•ï¼Œå¯ä»¥æ­£å¸¸ exitï¼Œä¹Ÿå¯ä»¥ abortï¼Œå–å†³äº DebugDontCrash&lt;/p&gt;

&lt;div class=&quot;language-objc highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;_objc_fatalv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;uint64_t&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reason&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;uint64_t&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flags&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fmt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;va_list&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ap&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;buf1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;vasprintf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;buf1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fmt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ap&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

    &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;buf2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;asprintf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;buf2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;objc[%d]: %s&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;getpid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;buf1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;_objc_syslog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;buf2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DebugDontCrash&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;buf3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;asprintf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;buf3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;objc[%d]: HALTED&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;getpid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;());&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;_objc_syslog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;buf3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;_Exit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;abort_with_reason&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;OS_REASON_OBJC&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reason&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;buf1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flags&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;ä¸Šé¢çš„æµç¨‹å¤§è‡´æ˜¯å°† weak æè¿°çš„å˜é‡å­˜èµ·æ¥çš„è¿‡ç¨‹ï¼Œæˆ‘ä»¬å†æŒ–æ˜ä¸‹å¯¹è±¡é‡Šæ”¾åï¼Œweak å˜é‡è‡ªåŠ¨ç½®ç©ºçš„é€»è¾‘:&lt;/p&gt;

&lt;h2 id=&quot;dealloc-æ—¶æ¸…ç†æ‰-weak-å˜é‡&quot;&gt;dealloc æ—¶æ¸…ç†æ‰ weak å˜é‡&lt;/h2&gt;

&lt;p&gt;æ—¢ç„¶æˆ‘ä»¬çŸ¥é“äº†ç»“è®ºï¼Œé‚£ä¹ˆå°±ç›´æ¥ä» dealloc å¼€å§‹çœ‹æ–¹æ³•è°ƒç”¨å§:&lt;/p&gt;

&lt;div class=&quot;language-objc highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dealloc&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;_objc_rootDealloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_objc_rootDealloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;id&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;obj&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;assert&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;obj&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;obj&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rootDealloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;kr&quot;&gt;inline&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;objc_object&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rootDealloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;isTaggedPointer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;object_dispose&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;id&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;object_dispose&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;id&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;obj&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; 
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_dealloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;obj&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; 
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;///æ³¨æ„ _dealloc å…¶å®å°±æ˜¯ _object_dispose
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;id&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_dealloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_object_dispose&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;id&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;_object_dispose&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;id&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;anObject&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; 
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;anObject&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;nil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;nil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;objc_destructInstance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;anObject&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;anObject&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;initIsa&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_objc_getFreedObjectClass&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;());&lt;/span&gt; 

    &lt;span class=&quot;n&quot;&gt;free&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;anObject&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;nil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;çœ‹æ³¨é‡Šå¯ä»¥çŸ¥é“ï¼Œè¿™ä¸ªæ–¹æ³•æ˜¯å¹²æ¸…ç†çš„å·¥ä½œçš„ï¼Œä¸é‡Šæ”¾å¯¹è±¡çš„å†…å­˜ï¼›å…·ä½“æ˜¯æ¸…ç†å…³è”åº”ç”¨çš„å¯¹è±¡å’Œå­˜å‚¨çš„ weak æŒ‡é’ˆ :&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;/***********************************************************************
* objc_destructInstance
* Destroys an instance without freeing memory. 
* Calls C++ destructors.
* Removes associative references.
* Returns `obj`. Does nothing if `obj` is nil.
* CoreFoundation and other clients do call this under GC.
**********************************************************************/

void *objc_destructInstance(id obj) 
{
    if (obj) {
        Class isa = obj-&amp;gt;getIsa();

        if (isa-&amp;gt;hasCxxDtor()) {
            object_cxxDestruct(obj);
        }
		 ///ä¹‹å‰çœ‹å…³è”å¼•ç”¨çš„æ—¶å€™ï¼Œå·²ç»çœ‹è¿‡è¿™ä¸ªæ–¹æ³•
        if (isa-&amp;gt;instancesHaveAssociatedObjects()) {
            _object_remove_assocations(obj);
        }
		 ///ä»Šå¤©æ¥çœ‹ä¸‹æ¸…ç† weak æŒ‡é’ˆçš„æ–¹æ³•å§
        objc_clear_deallocating(obj);
    }

    return obj;
}

void objc_clear_deallocating(id obj) 
{
    assert(obj);

    if (obj-&amp;gt;isTaggedPointer()) return;
    obj-&amp;gt;clearDeallocating();
}


inline void objc_object::clearDeallocating()
{
    sidetable_clearDeallocating();
}

void objc_object::sidetable_clearDeallocating()
{
    SideTable&amp;amp; table = SideTables()[this];

    // clear any weak table items
    // clear extra retain count and deallocating bit
    // (fixme warn or abort if extra retain count == 0 ?)
    table.lock();
    RefcountMap::iterator it = table.refcnts.find(this);
    if (it != table.refcnts.end()) {
        if (it-&amp;gt;second &amp;amp; SIDE_TABLE_WEAKLY_REFERENCED) {
            weak_clear_no_lock(&amp;amp;table.weak_table, (id)this);
        }
        table.refcnts.erase(it);
    }
    table.unlock();
}

/** 
 * Called by dealloc; nils out all weak pointers that point to the 
 * provided object so that they can no longer be used.
 * 
 * @param weak_table 
 * @param referent The object being deallocated. 
 */
void 
weak_clear_no_lock(weak_table_t *weak_table, id referent_id) 
{
    objc_object *referent = (objc_object *)referent_id;

    weak_entry_t *entry = weak_entry_for_referent(weak_table, referent);
    if (entry == nil) {
        /// XXX shouldn't happen, but does with mismatched CF/objc
        //printf(&quot;XXX no entry for clear deallocating %p\n&quot;, referent);
        return;
    }

    // zero out references
    weak_referrer_t *referrers;
    size_t count;
    
    if (entry-&amp;gt;out_of_line()) {
        referrers = entry-&amp;gt;referrers;
        count = TABLE_SIZE(entry);
    } 
    else {
        referrers = entry-&amp;gt;inline_referrers;
        count = WEAK_INLINE_COUNT;
    }
    
    for (size_t i = 0; i &amp;lt; count; ++i) {
        objc_object **referrer = referrers[i];
        if (referrer) {
            if (*referrer == referent) {
                *referrer = nil;
            }
            else if (*referrer) {
                _objc_inform(&quot;__weak variable at %p holds %p instead of %p. &quot;
                             &quot;This is probably incorrect use of &quot;
                             &quot;objc_storeWeak() and objc_loadWeak(). &quot;
                             &quot;Break on objc_weak_error to debug.\n&quot;, 
                             referrer, (void*)*referrer, (void*)referent);
                objc_weak_error();
            }
        }
    }
    
    weak_entry_remove(weak_table, entry);
}
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;æ‰¾äº†åŠå¤©ï¼Œæˆ‘ä»¬æƒ³çœ‹åˆ°çš„ä»£ç æ— éæ˜¯åœ¨deallocé‡Œæ‰§è¡Œç½®ç©ºå’Œä»tableé‡Œç§»é™¤ï¼š&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;if (*referrer == referent) {
    *referrer = nil;
}
weak_entry_remove(weak_table, entry);

&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;æˆªæ­¢åˆ°ä»Šæ—¥ï¼Œäº†è§£äº†å¯¹è±¡ dealloc æ—¶ç³»ç»Ÿæ¡†æ¶åˆ°åº•åšäº†ä»€ä¹ˆï¼Œæ¸…æ¥šçš„çŸ¥é“äº†å…³è”å¼•ç”¨å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸå’Œ weak å˜é‡ç½®ç©ºçš„åŸç†ï¼Œå¯¹äºæ—¥åä¿®æ”¹ä¸€äº›é—®é¢˜ï¼Œå®ç°æŸäº›ç‰¹æ€§çš„é€»è¾‘(ç½‘ç»œåº“é‡Œçš„è‡ªåŠ¨å–æ¶ˆå°±æ˜¯é€šè¿‡å…³è”å¼•ç”¨åšçš„ï¼Œåˆ©ç”¨äº†å¯¹è±¡é‡Šæ”¾æ—¶ï¼Œè‡ªåŠ¨é‡Šæ”¾å…³è”å¯¹è±¡è¿™ä¸€ç‰¹æ€§)ï¼Œå°±æ›´åŠ æœ‰æŠŠæ¡äº†ï¼&lt;/p&gt;

&lt;p&gt;æ³¨ï¼šobjc çš„æºç æ˜¯ä¸€ç›´åœ¨æ›´æ–°çš„ï¼Œå¦‚æœä½ çœ‹çš„ä¸æ˜¯ objc4-709.tar.gz è¿™ä¸ªåŒ…çš„è¯ï¼Œå¯èƒ½æºç ä¸æˆ‘è´´çš„æœ‰å·®å¼‚ï¼&lt;/p&gt;</content><author><name>è®¸ä¹¾éš†</name><email>qianlongxu@gmail.com</email></author><summary type="html">æˆ‘ä»¬éƒ½çŸ¥é“ weak ä¿®é¥°çš„å˜é‡ï¼Œåœ¨å¯¹è±¡é‡Šæ”¾åï¼Œä¼šè‡ªåŠ¨ç½®ä¸º nilï¼Œè¿™ä¸€æœºåˆ¶å‡å°‘äº†å¤§é‡çš„é‡æŒ‡é’ˆå´©æºƒï¼›æˆ‘ä»¬è¿˜çŸ¥é“åœ¨ dealloc é‡Œä¸è¦ weak ä¿®é¥° self å¯¹è±¡ï¼Œå¦åˆ™å½“å¯¹è±¡ dealloc æ—¶å°±ä¼šå´©æºƒæ‰ï¼›ä¸€èµ·çœ‹ä¸‹æºç å®ç°å§!</summary></entry><entry><title type="html">åœ¨ dealloc é‡Œä½¿ç”¨ weak self å¼•èµ·å´©æºƒï¼Ÿ</title><link href="http://localhost:4000/ios/2017/07/17/weakself-in-dealloc-cause-crash/" rel="alternate" type="text/html" title="åœ¨ dealloc é‡Œä½¿ç”¨ weak self å¼•èµ·å´©æºƒï¼Ÿ" /><published>2017-07-17T14:43:15+08:00</published><updated>2017-07-17T14:43:15+08:00</updated><id>http://localhost:4000/ios/2017/07/17/weakself-in-dealloc-cause-crash</id><content type="html" xml:base="http://localhost:4000/ios/2017/07/17/weakself-in-dealloc-cause-crash/">&lt;blockquote&gt;
  &lt;p&gt;æˆ‘ä»¬éƒ½çŸ¥é“ weak ä¿®é¥°çš„å˜é‡ï¼Œåœ¨å¯¹è±¡é‡Šæ”¾åï¼Œä¼šè‡ªåŠ¨ç½®ä¸º nilï¼Œè¿™ä¸€æœºåˆ¶å‡å°‘äº†å¤§é‡çš„é‡æŒ‡é’ˆå´©æºƒï¼›å¯æ˜¯å¦‚æœä½ åœ¨å¯¹è±¡çš„ dealloc é‡Œä½¿ç”¨ weak ä¿®é¥° self ä¼šå¦‚ä½•å‘¢ ï¼Ÿç­”æ¡ˆæ˜¯å´©æºƒ ~_~ æœ€è¿‘æˆ‘ä»¬ SDK åœ¨é›†æˆåˆ°æŸä¸ª App ä¹‹åï¼Œå°±é‡åˆ°äº†è¿™æ ·çš„é—®é¢˜ï¼Œä¸€èµ·çœ‹ä¸‹å§ï¼&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;å…ˆçœ‹ä¸‹è§£æåçš„å´©æºƒæ—¥å¿—å§ï¼š&lt;/p&gt;

&lt;div class=&quot;language-objc highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;Thread&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Crashed&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;   &lt;span class=&quot;n&quot;&gt;libsystem_kernel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dylib&lt;/span&gt;        	&lt;span class=&quot;mh&quot;&gt;0x0000000182c1987c&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;__terminate_with_payload&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;   &lt;span class=&quot;n&quot;&gt;libsystem_kernel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dylib&lt;/span&gt;        	&lt;span class=&quot;mh&quot;&gt;0x0000000182c144f0&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;abort_with_payload&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;   &lt;span class=&quot;n&quot;&gt;libsystem_kernel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dylib&lt;/span&gt;        	&lt;span class=&quot;mh&quot;&gt;0x0000000182c1446c&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;abort_with_payload_wrapper_internal&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;   &lt;span class=&quot;n&quot;&gt;libobjc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dylib&lt;/span&gt;               	&lt;span class=&quot;mh&quot;&gt;0x000000018267fea4&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_objc_fatalv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;long&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;long&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;112&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;   &lt;span class=&quot;n&quot;&gt;libobjc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dylib&lt;/span&gt;               	&lt;span class=&quot;mh&quot;&gt;0x000000018267fdfc&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;__objc_error&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;   &lt;span class=&quot;n&quot;&gt;libobjc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dylib&lt;/span&gt;               	&lt;span class=&quot;mh&quot;&gt;0x0000000182693edc&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;weak_entry_insert&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;weak_table_t&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;weak_entry_t&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;   &lt;span class=&quot;n&quot;&gt;libobjc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dylib&lt;/span&gt;               	&lt;span class=&quot;mh&quot;&gt;0x000000018269c3ac&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;objc_storeWeak&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;332&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;   &lt;span class=&quot;n&quot;&gt;SOHUVideo&lt;/span&gt;                     	&lt;span class=&quot;mh&quot;&gt;0x00000001004b5ba0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SharePopView&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;setDelegate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SharePopView&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;h&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;31&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;   &lt;span class=&quot;n&quot;&gt;SOHUVideo&lt;/span&gt;                     	&lt;span class=&quot;mh&quot;&gt;0x00000001003ce7c8&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ShareViewController&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;shareView&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ShareViewController&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;70&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;   &lt;span class=&quot;n&quot;&gt;SOHUVideo&lt;/span&gt;                     	&lt;span class=&quot;mh&quot;&gt;0x00000001003ce2a0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ShareViewController&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;dealloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ShareViewController&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;43&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;UIKit&lt;/span&gt;                         	&lt;span class=&quot;mh&quot;&gt;0x000000018a0a5960&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;UIPresentationController&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;cxx_destruct&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;312&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;11&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;libobjc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dylib&lt;/span&gt;               	&lt;span class=&quot;mh&quot;&gt;0x000000018267ef00&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;object_cxxDestructFromClass&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;objc_object&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;objc_class&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;148&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;12&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;libobjc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dylib&lt;/span&gt;               	&lt;span class=&quot;mh&quot;&gt;0x000000018268c334&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;objc_destructInstance&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;92&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;13&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;libobjc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dylib&lt;/span&gt;               	&lt;span class=&quot;mh&quot;&gt;0x000000018268c398&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;object_dispose&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;28&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;14&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;UIKit&lt;/span&gt;                         	&lt;span class=&quot;mh&quot;&gt;0x000000018a0a1348&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;UIPresentationController&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;dealloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;64&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;å¦‚æœè¿ç€çº¿ç›´æ¥ debug çš„è¯ï¼Œå¯èƒ½æ§åˆ¶å°åªè¾“å‡ºäº†è¿™æ ·ä¸€å¥è¯ï¼Œå¹¶ä¸”ä»£ç å®šä½åˆ°ä½¿ç”¨ weak self é‚£ä¸€è¡Œï¼Œæ­¤æ—¶å¯ä»¥ä½¿ç”¨ &lt;code class=&quot;highlighter-rouge&quot;&gt;bt&lt;/code&gt; æ‰“å°å †æ ˆä¿¡æ¯ï¼Œæ‰“å‡ºæ¥è·Ÿä¸Šé¢æ˜¯ä¸€æ ·:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;objc[78013]: Cannot form weak reference to instance (0x7fbc9287e840) of class ShareViewController. It is possible that this object was over-released, or is in the process of deallocation.
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;æ¥ä¸‹æ¥æˆ‘ä»¬ä¸€è¡Œä¸€è¡Œçš„åˆ†æå´©æºƒæ—¥å¿—ï¼Œç„¶åç¡®å®šé—®é¢˜ï¼Œè¿™æ˜¯å‡½æ•°è°ƒç”¨æ ˆï¼Œå› æ­¤å…ˆèµ°çš„æ–¹æ³•åœ¨ä¸‹é¢ï¼Œæœ€ä¸Šé¢çš„æ˜¯æœ€åèµ°çš„æ–¹æ³•ï¼Œå› æ­¤æˆ‘ä»¬å€’ç€æ¥çœ‹ï¼Œä»ç¬¬ 9 è¡Œçœ‹å°±å¥½äº†ï¼š&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;9 : ShareViewController çš„ dealloc èµ°äº†
8 : è®¿é—®äº† ShareViewController å¯¹è±¡çš„å±æ€§ shareView
7 : ç»™ shareView è®¾ç½®äº†ä»£ç†å¯¹è±¡
6 : çœ‹åº“åçŸ¥é“è¿™æ˜¯èµ°åˆ°äº† objc åº•å±‚äº†ï¼Œçœ‹æ–¹æ³•åçŸ¥é“è¿™ä¸ªæ“ä½œåº”è¯¥æ˜¯è¦å­˜å‚¨ä¸€ä¸ª weak ä¿®é¥°çš„å¯¹è±¡
5 : å°† weak entry æ’å…¥åˆ° table é‡Œ
4 : é‡åˆ°äº†é”™è¯¯
3 : å¤„ç†è‡´å‘½é”™è¯¯
2 : ä»£ç ç»§ç»­å¾€ä¸‹èµ°ï¼Œobjc äº¤ç»™äº† system å¤„ç†
1 : ç³»ç»Ÿç»ˆç»“äº†ä½ çš„ç¨‹åº
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;åº•å±‚çš„é”™è¯¯è‚¯å®šæ˜¯ä¸Šå±‚è°ƒç”¨é”™è¯¯å¼•èµ·çš„ï¼Œå› æ­¤æˆ‘ä»¬åªçœ‹ App å±‚æœ€åä¸€ä¸ªæ–¹æ³•è°ƒç”¨ï¼Œé‚£å°±æ˜¯ &lt;code class=&quot;highlighter-rouge&quot;&gt;[SharePopView setDelegate:]&lt;/code&gt;ï¼Œæºç æ˜¯è¿™æ ·å†™çš„:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dealloc&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shareView&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;delegate&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;nil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shareView&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;nil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SharePopView&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shareView&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_shareView&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;CGFloat&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;titleHeight&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ShareIconViewHeightForSL&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bottomTitleHeight&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cancelButtonHeight&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;_shareView&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SharePopView&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;alloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;initWithFrame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;CGRectMake&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DeviceHeight&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DeviceWidth&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)];&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;_shareView&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;delegate&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;///è¿ç€çº¿è°ƒè¯•æ—¶ï¼Œå´©æºƒåå®šä½åˆ°äº†è¿™ä¸€è¡Œï¼ï¼ï¼
&lt;/span&gt;    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_shareView&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;@interface&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;SharePopView&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;UIView&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;////è¿™é‡Œä½¿ç”¨çš„æ˜¯ weak ä¿®é¥°çš„
&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;@property&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nonatomic&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;weak&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SharePopupViewDelegate&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;delegate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;@end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;æˆ‘çœ‹åˆ°è¿™ä¸ªä»£ç çš„ç¬¬ä¸€ååº”æ˜¯ï¼Œ&lt;strong&gt;dealloc ä¸åº”è¯¥ä½¿ç”¨ self æ‰“ç‚¹è®¿é—®æ‡’åŠ è½½çš„å±æ€§&lt;/strong&gt;ï¼Œæˆ‘ä¹Ÿç»å¸¸é‡å†™ get æ–¹æ³•æ¥æ‡’åŠ è½½ï¼Œå› æ­¤æˆ‘å¯¹äºè¿™ä¸ªå¾ˆæ•æ„Ÿï¼Œå› ä¸ºå¯¹è±¡æ­£åœ¨é‡Šæ”¾ï¼Œæ²¡æœ‰åˆ›å»ºç›¸å…³å±æ€§çš„å¿…è¦äº†ï¼Œè¿™é‡Œä¹‹æ‰€ä»¥å´©æºƒï¼Œæ˜¯å› ä¸ºåˆ›å»ºå¯¹è±¡ä¹‹åï¼Œç«‹é©¬æŒ‡å®šäº† self ä¸ºä»£ç†ï¼Œå¹¶ä¸”æ˜¯ weak çš„ï¼Œä»å´©æºƒå †æ ˆä¿¡æ¯ä¹Ÿèƒ½çœ‹å‡ºï¼Œè®¾ç½®äº†weakä¿®é¥°çš„ä»£ç†åï¼Œobjc åº•å±‚å¯¹ self è¿›è¡Œäº†å¤„ç†ï¼Œåœ¨å¤„ç†çš„æ—¶å€™ï¼Œå‘ç°ä¸å¯¹åŠ²ï¼Œç„¶åå°± abort äº†ï¼ï¼&lt;/p&gt;

&lt;p&gt;ps : ä¸ç®¡æ˜¯ä½¿ç”¨ weak ä¿®é¥°çš„å±æ€§ï¼Œè¿˜æ˜¯ä½¿ç”¨ __weak ä¿®é¥°çš„å˜é‡ï¼Œobjc éƒ½ä¼šå¯¹è¿™ä¸ªå˜é‡å¤„ç†ï¼Œä¹Ÿåªæœ‰è¿™æ ·æ‰èƒ½è®©ä¿®é¥°å¯¹è±¡åœ¨é‡Šæ”¾ä¹‹åï¼Œè‡ªåŠ¨ç½®ç©ºï¼&lt;/p&gt;

&lt;p&gt;çœ‹åˆ°æºç é—®é¢˜å°±å¥½è§£å†³äº†ï¼ŒåŠ ä¸ªåˆ¤æ–­å°±è¡Œäº†ï¼Œä¸è¦æ‡’åŠ è½½å»åˆ›å»ºï¼Œè€Œæ˜¯åˆ¤æ–­ä¸‹ï¼Œå¦‚æœåˆ›å»ºè¿‡å°±å°†ä»£ç†ç½®ç©ºï¼Œè¿™æ ·å°±é¿å…äº†åœ¨ dealloc é‡Œä½¿ç”¨ weak ä¿®é¥° self å¯¹è±¡ï¼&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;- (void)dealloc {
	if(_shareView){
	 	_shareView.delegate = nil;
    	_shareView = nil;
	}
}
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;é—®é¢˜æ˜¯è§£å†³äº†ï¼Œå¯æ˜¯è¿˜æ²¡ææ˜ç™½åº•å±‚ objc çš„å¤„ç†æµç¨‹å‘¢ï¼Œæœ‰å…´è¶£çš„è¯æ¥ç€å¾€ä¸‹çœ‹å§ï¼š&lt;a href=&quot;/ios/2017/07/17/objc-weak-obj-imp.html&quot;&gt;æºç åˆ†æ weak å¯¹è±¡ç½®ç©ºåŸç†&lt;/a&gt;.&lt;/p&gt;</content><author><name>è®¸ä¹¾éš†</name><email>qianlongxu@gmail.com</email></author><summary type="html">æˆ‘ä»¬éƒ½çŸ¥é“ weak ä¿®é¥°çš„å˜é‡ï¼Œåœ¨å¯¹è±¡é‡Šæ”¾åï¼Œä¼šè‡ªåŠ¨ç½®ä¸º nilï¼Œè¿™ä¸€æœºåˆ¶å‡å°‘äº†å¤§é‡çš„é‡æŒ‡é’ˆå´©æºƒï¼›å¯æ˜¯å¦‚æœä½ åœ¨å¯¹è±¡çš„ dealloc é‡Œä½¿ç”¨ weak ä¿®é¥° self ä¼šå¦‚ä½•å‘¢ ï¼Ÿç­”æ¡ˆæ˜¯å´©æºƒ ~_~ æœ€è¿‘æˆ‘ä»¬ SDK åœ¨é›†æˆåˆ°æŸä¸ª App ä¹‹åï¼Œå°±é‡åˆ°äº†è¿™æ ·çš„é—®é¢˜ï¼Œä¸€èµ·çœ‹ä¸‹å§ï¼</summary></entry><entry><title type="html">è§£å†³ NSTimer å†…å­˜æ³„æ¼é—®é¢˜</title><link href="http://localhost:4000/ios/2015/07/14/jie-jue-nstimeryin-qi-de-nei-cun-xie-lou/" rel="alternate" type="text/html" title="è§£å†³ NSTimer å†…å­˜æ³„æ¼é—®é¢˜" /><published>2015-07-14T10:38:52+08:00</published><updated>2015-07-14T10:38:52+08:00</updated><id>http://localhost:4000/ios/2015/07/14/jie-jue-nstimeryin-qi-de-nei-cun-xie-lou</id><content type="html" xml:base="http://localhost:4000/ios/2015/07/14/jie-jue-nstimeryin-qi-de-nei-cun-xie-lou/">&lt;blockquote&gt;
  &lt;p&gt;NSTimer æ˜¯ iOS å¾ˆå¸¸ç”¨çš„ä¸€ä¸ªç±»ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿çš„åšå»¶è¿Ÿä»»åŠ¡ï¼Œä¹Ÿå¯ä»¥åšå‘¨æœŸæ€§çš„è½®è¯¢ã€‚ä¸è¿‡æˆ‘åœ¨å†™è½®æ’­å›¾çš„æ—¶å€™å´å‘ç° Timeré€ æˆäº†å†…å­˜æ³„æ¼ï¼&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;èƒŒæ™¯&quot;&gt;èƒŒæ™¯&lt;/h2&gt;

&lt;p&gt;æˆ‘åœ¨ ViewController é‡Œä½¿ç”¨äº† Timerï¼Œç»“æœå‘ç° pop æ‰è¯¥æ§åˆ¶å™¨åï¼Œä»–çš„ dealloc å´æ²¡æœ‰è°ƒç”¨ï¼è¿™æ˜¯ä¸ªå†…å­˜æ³„éœ²çš„é—®é¢˜ï¼Œæ¯”è¾ƒä¸¥é‡ï¼Œè¦å°½å¿«è§£å†³ï¼&lt;/p&gt;

&lt;h2 id=&quot;åˆ†æåŸå› &quot;&gt;åˆ†æåŸå› &lt;/h2&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;åœ¨ä½¿ç”¨ Timer çš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦ç»™ä»–æŒ‡å®šä¸€ä¸ª Targetï¼Œè€Œ Timer çš„å†…éƒ¨ä¼šæŒæœ‰è¯¥ Targetï¼ŒåŸå› å¯æƒ³è€ŒçŸ¥ï¼Œå½“ Timer åˆ°æ—¶é—´ä¹‹åå°±è¦è§¦å‘ç›®æ ‡æ–¹æ³•ï¼Œå¦‚æœä¸æŒæœ‰ Target çš„è¯ï¼Œå°±å¯èƒ½ä¼šå¯¼è‡´ Target å·²ç»é‡Šæ”¾ï¼Œæ— æ³•è¾¾åˆ°è°ƒç”¨ç›®æ ‡æ–¹æ³•çš„æ•ˆæœï¼›åœ¨æ²¡æœ‰ARCçš„å¹´ä»£ï¼Œå¦‚æœç”¨assignåŠ¿å¿…ä¼šé€ æˆé‡æŒ‡é’ˆå´©æºƒçš„ï¼Œå› æ­¤è¦æŒæœ‰ Targetï¼›&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;è¦çŸ¥é“ Timer çš„è¿è¡Œä¾èµ–äº Runloop çš„é©±åŠ¨ï¼Œå³ fire ä¹‹å‰éœ€è¦åŠ å…¥åˆ° Runloop ä¸­ï¼Œä½†è¿™æ ·ä¸€æ¥ Timer å°±è¢« Runloop æŒæœ‰äº†ï¼Œé™¤éè°ƒç”¨ invalidateï¼Œæ‰ä¼šä» Runloop ä¸­ç§»é™¤ï¼›&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;å®é™…ä½¿ç”¨çš„æ—¶å€™ï¼ŒTarget å°±æ˜¯æˆ‘çš„ ViewControllerï¼Œæˆ‘æ˜¯åœ¨ ViewController çš„ dealloc é‡Œå°† Timer invalidate æ‰çš„ï¼›&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;å¦‚ä¸Šæ‰€è¿°ï¼ŒTarget ä¼šè¢« Timer æŒæœ‰ï¼ŒTimer ä¼šè¢« Runloop æŒæœ‰ï¼Œç»“æœå°±å¯¼è‡´äº† ViewController ä¸€ç›´è¢«æŒæœ‰ç€ï¼Œæ‰€ä»¥åœ¨ ViewController çš„ dealloc é‡Œ invalidate æ‰ Timer æ˜¯æ²¡ä½œç”¨çš„ï¼Œå‹æ ¹ä¸ä¼šèµ°è¿™ä¸ªé€»è¾‘ï¼Œæ‰€ä»¥å½“å¯¼èˆªæ§åˆ¶å™¨ pop ä¹‹åï¼Œé¡µé¢æ¶ˆå¤±äº†ï¼Œä½†æ˜¯å†…å­˜å´æ²¡é‡Šæ”¾ï¼Œè¿™å°±å¯¼è‡´äº†å†…å­˜æ³„æ¼ï¼&lt;/p&gt;

&lt;h2 id=&quot;è§£å†³é—®é¢˜&quot;&gt;è§£å†³é—®é¢˜&lt;/h2&gt;

&lt;p&gt;å¦‚æœèƒ½åœ¨ pop ViewController ä¹‹å‰å°† Timer invalidate æ‰ï¼Œå°±å¯ä»¥è§£é™¤ Timer å¯¹ ViewController çš„æŒæœ‰ï¼Œè®© ViewController æ­£å¸¸é‡Šæ”¾ï¼›&lt;/p&gt;

&lt;p&gt;ç®€å•çš„åšæ³•æ˜¯åœ¨æ§åˆ¶å™¨çš„ viewwilldisappear ä¸­ invalidateï¼Œä¸è¿‡ä¸€èˆ¬æƒ…å†µä¸‹å°±è¦å¯¹åº”çš„åœ¨ viewwillappear ä¸­é‡æ–°åˆ›å»º Timerï¼Œè¿™ä¹ˆåšä¸€èˆ¬æƒ…å†µéƒ½æ˜¯å¯ä»¥çš„ï¼Œä½†å¦‚æœ Target ä¸æ˜¯ ViewController å°±éœ€è¦å¤šå†™ç‚¹ä»£ç äº†ï¼›æ›´ç³Ÿç³•çš„æ˜¯ï¼Œæˆ‘é‡åˆ°è¿‡è°ƒç”¨äº† viewwillappear å´æ²¡è°ƒç”¨ viewwilldisappear å°±è¦dealloc çš„æƒ…å†µï¼Œè¿™æ—¶æƒ…å†µå°±å¾ˆç³Ÿç³•äº†ï¼Œçœ‹æ¥éœ€è¦ä¸€ä¸ªä¼˜é›…çš„è§£å†³åŠæ³•æ‰æ˜¯å®Œå…¨ä¹‹ç­–ã€‚&lt;/p&gt;

&lt;p&gt;è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå°±è¦ä»æ‰“ç ´æŒæœ‰ä¸Šè§£å†³ï¼ŒRunloop æŒæœ‰ Timer ä¼°è®¡æ˜¯æ²¡åŠæ³•åšæ–‡ç« äº†ï¼Œé‚£èƒ½ä¸èƒ½æƒ³åŠæ³•æŠŠ Target è½¬ç§»ä¸‹å‘¢? æ˜¯çš„ï¼Œå¯ä»¥å°†è‡ªèº«ä½œä¸º Targetï¼Œç„¶åé€šè¿‡ block å›è°ƒå‡ºå»ï¼Ÿå¤–éƒ¨è°ƒç”¨ä½¿ç”¨ weak-storng dance ï¼Œä¸è®© block
æŒæœ‰ targetï¼›ä¼¼ä¹å¯è¡Œå“¦ï¼Œç«‹é©¬è¡ŒåŠ¨ï¼š&lt;/p&gt;

&lt;div class=&quot;language-objc highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NSTimer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;scheduledWithTimeInterval&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NSTimeInterval&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;ti&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;repeats&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;BOOL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;yesOrNo&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;block&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;^&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)())&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;block&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
   &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NSTimer&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;scheduledTimerWithTimeInterval&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ti&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;target&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;self&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;selector&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;@selector&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ql_blockInvoke&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;userInfo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;block&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;copy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;repeats&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;yesOrNo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;æŠŠä¼ å…¥çš„blockå½“ä½œuserinfoç©¿è¿‡å»ï¼Œuserinfoæ˜¯ä¸ªidç±»å‹çš„ï¼Œæ•…è€Œå¯ä»¥ä¼ é€’ä¸€ä¸ªblockè¿‡å»ï¼Œblockæ˜¯åœ¨æ ˆä¸Šåˆ†é…çš„ï¼Œæ‰€ä»¥å¿…é¡»copyåˆ°å †ä¸Šï¼Œè¿™æ ·æ—¥åå›è°ƒçš„æ—¶å€™æ‰èƒ½æ‰¾åˆ°å®ƒï¼›&lt;/p&gt;

&lt;div class=&quot;language-objc highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;ql_blockInvoke&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NSTimer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;sender&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;^&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;block&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sender&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;userInfo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;block&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;block&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;é€šè¿‡ç±»åˆ«ï¼Œæˆ‘ä»¬ç»™timeråŠ ä¸Šäº†è¿™äº›æ–¹æ³•ï¼›&lt;/p&gt;

&lt;h3 id=&quot;ä½¿ç”¨&quot;&gt;ä½¿ç”¨&lt;/h3&gt;

&lt;div class=&quot;language-objc highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;__weak&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;__typeof&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;weakSelf&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;NSTimer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;timer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NSTimer&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;scheduledWithTimeInterval&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;animationDuration&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;repeats&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;YES&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;block&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:^&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;__strong&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;__typeof&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;weakSelf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;strongSelf&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;weakSelf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
   &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;strongSelf&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;animationTimerDidFired&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}];&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;ä½¿ç”¨scheduledTimerWithTimeIntervalæ–¹æ³•åˆ›å»ºçš„timerä¼šè‡ªåŠ¨åŠ å…¥åˆ°å½“å‰runloopä¸­ï¼Œå¹¶åœ¨intervalä¹‹åfireï¼›å¦‚æœä¸æƒ³ç«‹é©¬å¼€å§‹å¯ä»¥è¿™æ ·åšï¼š&lt;/p&gt;

&lt;div class=&quot;language-objc highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;timer&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;setFireDate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NSDate&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;distantFuture&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]];&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;è®°å¾—åœ¨targetçš„deallocé‡ŒæŠŠè¿™ä¸ªtimer invalidateå³å¯ï¼›&lt;/p&gt;

&lt;h3 id=&quot;å¢åŠ äº†å‡ ä¸ªæ–¹ä¾¿çš„æ–¹æ³•&quot;&gt;å¢åŠ äº†å‡ ä¸ªæ–¹ä¾¿çš„æ–¹æ³•&lt;/h3&gt;

&lt;div class=&quot;language-objc highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pauseTimer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;resumeTimer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;resumeTimerAfterTimeInterval&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NSTimeInterval&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;interval&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h2 id=&quot;å®Œ&quot;&gt;å®Œ&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;å¼€æºåœ°å€ï¼š&lt;a href=&quot;https://github.com/debugly/QLCodes&quot;&gt;https://github.com/debugly/QLCodes&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content><author><name>è®¸ä¹¾éš†</name><email>qianlongxu@gmail.com</email></author><summary type="html">NSTimer æ˜¯ iOS å¾ˆå¸¸ç”¨çš„ä¸€ä¸ªç±»ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿çš„åšå»¶è¿Ÿä»»åŠ¡ï¼Œä¹Ÿå¯ä»¥åšå‘¨æœŸæ€§çš„è½®è¯¢ã€‚ä¸è¿‡æˆ‘åœ¨å†™è½®æ’­å›¾çš„æ—¶å€™å´å‘ç° Timeré€ æˆäº†å†…å­˜æ³„æ¼ï¼</summary></entry><entry><title type="html">Hello My Blog</title><link href="http://localhost:4000/script/2015/07/07/bo-ke-an-jia-la/" rel="alternate" type="text/html" title="Hello My Blog" /><published>2015-07-07T13:36:28+08:00</published><updated>2015-07-07T13:36:28+08:00</updated><id>http://localhost:4000/script/2015/07/07/bo-ke-an-jia-la</id><content type="html" xml:base="http://localhost:4000/script/2015/07/07/bo-ke-an-jia-la/">&lt;blockquote&gt;
  &lt;p&gt;ä»Šå¤©å¼€é€šäº†è‡ªå·±çš„åšå®¢ï¼Œç¬é—´è§‰å¾—å†™åšå®¢æ˜¯ä¸€ç§è´£ä»»ï¼Œåº”å½“æŠŠä»–å½“ä½œäº‹ä¸šæ¥åšã€‚å†™åšå®¢çš„è¿‡ç¨‹ä¹Ÿæ˜¯è‡ªæˆ‘è®¤è¯†å’Œèƒ½åŠ›æå‡çš„ä¸€ä¸ªè¿‡ç¨‹ï¼Œå› ä¸ºè¦æŠŠä¸€ä¸ªä¸ç†Ÿæ‚‰çš„ä¸œè¥¿è¯´æ¸…æ¥šçœŸçš„å¾ˆå›°éš¾,æœ‰å›°éš¾æ‰ä¼šæœ‰è¿›æ­¥ï¼Œä¸æ˜¯å˜›ï¼Ÿ&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;æ³¨ï¼šæ­å»ºæ—¶ä½¿ç”¨çš„ octopressï¼Œç°åœ¨ä½¿ç”¨çš„æ˜¯ jekyllã€‚&lt;/p&gt;</content><author><name>è®¸ä¹¾éš†</name><email>qianlongxu@gmail.com</email></author><summary type="html">ä»Šå¤©å¼€é€šäº†è‡ªå·±çš„åšå®¢ï¼Œç¬é—´è§‰å¾—å†™åšå®¢æ˜¯ä¸€ç§è´£ä»»ï¼Œåº”å½“æŠŠä»–å½“ä½œäº‹ä¸šæ¥åšã€‚å†™åšå®¢çš„è¿‡ç¨‹ä¹Ÿæ˜¯è‡ªæˆ‘è®¤è¯†å’Œèƒ½åŠ›æå‡çš„ä¸€ä¸ªè¿‡ç¨‹ï¼Œå› ä¸ºè¦æŠŠä¸€ä¸ªä¸ç†Ÿæ‚‰çš„ä¸œè¥¿è¯´æ¸…æ¥šçœŸçš„å¾ˆå›°éš¾,æœ‰å›°éš¾æ‰ä¼šæœ‰è¿›æ­¥ï¼Œä¸æ˜¯å˜›ï¼Ÿ</summary></entry><entry><title type="html">Introducing Lanyon</title><link href="http://localhost:4000/2014/01/02/introducing-lanyon/" rel="alternate" type="text/html" title="Introducing Lanyon" /><published>2014-01-02T00:00:00+08:00</published><updated>2014-01-02T00:00:00+08:00</updated><id>http://localhost:4000/2014/01/02/introducing-lanyon</id><content type="html" xml:base="http://localhost:4000/2014/01/02/introducing-lanyon/">&lt;p&gt;Lanyon is an unassuming &lt;a href=&quot;http://jekyllrb.com&quot;&gt;Jekyll&lt;/a&gt; theme that places content first by tucking away navigation in a hidden drawer. Itâ€™s based on &lt;a href=&quot;http://getpoole.com&quot;&gt;Poole&lt;/a&gt;, the Jekyll butler.&lt;/p&gt;

&lt;h3 id=&quot;built-on-poole&quot;&gt;Built on Poole&lt;/h3&gt;

&lt;p&gt;Poole is the Jekyll Butler, serving as an upstanding and effective foundation for Jekyll themes by &lt;a href=&quot;https://twitter.com/mdo&quot;&gt;@mdo&lt;/a&gt;. Poole, and every theme built on it (like Lanyon here) includes the following:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Complete Jekyll setup included (layouts, config, &lt;a href=&quot;/404&quot;&gt;404&lt;/a&gt;, &lt;a href=&quot;/atom.xml&quot;&gt;RSS feed&lt;/a&gt;, posts, and &lt;a href=&quot;/about&quot;&gt;example page&lt;/a&gt;)&lt;/li&gt;
  &lt;li&gt;Mobile friendly design and development&lt;/li&gt;
  &lt;li&gt;Easily scalable text and component sizing with &lt;code class=&quot;highlighter-rouge&quot;&gt;rem&lt;/code&gt; units in the CSS&lt;/li&gt;
  &lt;li&gt;Support for a wide gamut of HTML elements&lt;/li&gt;
  &lt;li&gt;Related posts (time-based, because Jekyll) below each post&lt;/li&gt;
  &lt;li&gt;Syntax highlighting, courtesy Pygments (the Python-based code snippet highlighter)&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;lanyon-features&quot;&gt;Lanyon features&lt;/h3&gt;

&lt;p&gt;In addition to the features of Poole, Lanyon adds the following:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Toggleable sliding sidebar (built with only CSS) via &lt;strong&gt;â˜°&lt;/strong&gt; link in top corner&lt;/li&gt;
  &lt;li&gt;Sidebar includes support for textual modules and a dynamically generated navigation with active link support&lt;/li&gt;
  &lt;li&gt;Two orientations for content and sidebar, default (left sidebar) and &lt;a href=&quot;https://github.com/poole/lanyon#reverse-layout&quot;&gt;reverse&lt;/a&gt; (right sidebar), available via &lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;body&amp;gt;&lt;/code&gt; classes&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/poole/lanyon#themes&quot;&gt;Eight optional color schemes&lt;/a&gt;, available via &lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;body&amp;gt;&lt;/code&gt; classes&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/poole/lanyon#readme&quot;&gt;Head to the readme&lt;/a&gt; to learn more.&lt;/p&gt;

&lt;h3 id=&quot;browser-support&quot;&gt;Browser support&lt;/h3&gt;

&lt;p&gt;Lanyon is by preference a forward-thinking project. In addition to the latest versions of Chrome, Safari (mobile and desktop), and Firefox, it is only compatible with Internet Explorer 9 and above.&lt;/p&gt;

&lt;h3 id=&quot;download&quot;&gt;Download&lt;/h3&gt;

&lt;p&gt;Lanyon is developed on and hosted with GitHub. Head to the &lt;a href=&quot;https://github.com/poole/lanyon&quot;&gt;GitHub repository&lt;/a&gt; for downloads, bug reports, and features requests.&lt;/p&gt;

&lt;p&gt;Thanks!&lt;/p&gt;</content><author><name>è®¸ä¹¾éš†</name><email>qianlongxu@gmail.com</email></author><summary type="html">Lanyon is an unassuming Jekyll theme that places content first by tucking away navigation in a hidden drawer. Itâ€™s based on Poole, the Jekyll butler. Built on Poole Poole is the Jekyll Butler, serving as an upstanding and effective foundation for Jekyll themes by @mdo. Poole, and every theme built on it (like Lanyon here) includes the following: Complete Jekyll setup included (layouts, config, 404, RSS feed, posts, and example page) Mobile friendly design and development Easily scalable text and component sizing with rem units in the CSS Support for a wide gamut of HTML elements Related posts (time-based, because Jekyll) below each post Syntax highlighting, courtesy Pygments (the Python-based code snippet highlighter) Lanyon features In addition to the features of Poole, Lanyon adds the following: Toggleable sliding sidebar (built with only CSS) via â˜° link in top corner Sidebar includes support for textual modules and a dynamically generated navigation with active link support Two orientations for content and sidebar, default (left sidebar) and reverse (right sidebar), available via &amp;lt;body&amp;gt; classes Eight optional color schemes, available via &amp;lt;body&amp;gt; classes Head to the readme to learn more. Browser support Lanyon is by preference a forward-thinking project. In addition to the latest versions of Chrome, Safari (mobile and desktop), and Firefox, it is only compatible with Internet Explorer 9 and above. Download Lanyon is developed on and hosted with GitHub. Head to the GitHub repository for downloads, bug reports, and features requests. Thanks!</summary></entry><entry><title type="html">Example content</title><link href="http://localhost:4000/2014/01/01/example-content/" rel="alternate" type="text/html" title="Example content" /><published>2014-01-01T00:00:00+08:00</published><updated>2014-01-01T00:00:00+08:00</updated><id>http://localhost:4000/2014/01/01/example-content</id><content type="html" xml:base="http://localhost:4000/2014/01/01/example-content/">&lt;div class=&quot;message&quot;&gt;
  Howdy! This is an example blog post that shows several types of HTML content supported in this theme.
&lt;/div&gt;

&lt;p&gt;Cum sociis natoque penatibus et magnis &lt;a href=&quot;#&quot;&gt;dis parturient montes&lt;/a&gt;, nascetur ridiculus mus. &lt;em&gt;Aenean eu leo quam.&lt;/em&gt; Pellentesque ornare sem lacinia quam venenatis vestibulum. Sed posuere consectetur est at lobortis. Cras mattis consectetur purus sit amet fermentum.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Curabitur blandit tempus porttitor. Nullam quis risus eget urna mollis ornare vel eu leo. Nullam id dolor id nibh ultricies vehicula ut id elit.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Etiam porta &lt;strong&gt;sem malesuada magna&lt;/strong&gt; mollis euismod. Cras mattis consectetur purus sit amet fermentum. Aenean lacinia bibendum nulla sed consectetur.&lt;/p&gt;

&lt;h2 id=&quot;inline-html-elements&quot;&gt;Inline HTML elements&lt;/h2&gt;

&lt;p&gt;HTML defines a long list of available inline tags, a complete list of which can be found on the &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/HTML/Element&quot;&gt;Mozilla Developer Network&lt;/a&gt;.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;To bold text&lt;/strong&gt;, use &lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;strong&amp;gt;&lt;/code&gt;.&lt;/li&gt;
  &lt;li&gt;&lt;em&gt;To italicize text&lt;/em&gt;, use &lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;em&amp;gt;&lt;/code&gt;.&lt;/li&gt;
  &lt;li&gt;Abbreviations, like &lt;abbr title=&quot;HyperText Markup Langage&quot;&gt;HTML&lt;/abbr&gt; should use &lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;abbr&amp;gt;&lt;/code&gt;, with an optional &lt;code class=&quot;highlighter-rouge&quot;&gt;title&lt;/code&gt; attribute for the full phrase.&lt;/li&gt;
  &lt;li&gt;Citations, like &lt;cite&gt;â€” Mark otto&lt;/cite&gt;, should use &lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;cite&amp;gt;&lt;/code&gt;.&lt;/li&gt;
  &lt;li&gt;&lt;del&gt;Deleted&lt;/del&gt; text should use &lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;del&amp;gt;&lt;/code&gt; and &lt;ins&gt;inserted&lt;/ins&gt; text should use &lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;ins&amp;gt;&lt;/code&gt;.&lt;/li&gt;
  &lt;li&gt;Superscript &lt;sup&gt;text&lt;/sup&gt; uses &lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;sup&amp;gt;&lt;/code&gt; and subscript &lt;sub&gt;text&lt;/sub&gt; uses &lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;sub&amp;gt;&lt;/code&gt;.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Most of these elements are styled by browsers with few modifications on our part.&lt;/p&gt;

&lt;h2 id=&quot;heading&quot;&gt;Heading&lt;/h2&gt;

&lt;p&gt;Vivamus sagittis lacus vel augue rutrum faucibus dolor auctor. Duis mollis, est non commodo luctus, nisi erat porttitor ligula, eget lacinia odio sem nec elit. Morbi leo risus, porta ac consectetur ac, vestibulum at eros.&lt;/p&gt;

&lt;h3 id=&quot;code&quot;&gt;Code&lt;/h3&gt;

&lt;p&gt;Cum sociis natoque penatibus et magnis dis &lt;code class=&quot;highlighter-rouge&quot;&gt;code element&lt;/code&gt; montes, nascetur ridiculus mus.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-js&quot; data-lang=&quot;js&quot;&gt;&lt;span class=&quot;c1&quot;&gt;// Example can be run directly in your JavaScript console
&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// Create a function that takes two arguments and returns the sum of those arguments
&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;adder&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;Function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;a&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;b&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;return a + b&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// Call the function
&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;adder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;// &amp;gt; 8&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Aenean lacinia bibendum nulla sed consectetur. Etiam porta sem malesuada magna mollis euismod. Fusce dapibus, tellus ac cursus commodo, tortor mauris condimentum nibh, ut fermentum massa.&lt;/p&gt;

&lt;h3 id=&quot;lists&quot;&gt;Lists&lt;/h3&gt;

&lt;p&gt;Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Aenean lacinia bibendum nulla sed consectetur. Etiam porta sem malesuada magna mollis euismod. Fusce dapibus, tellus ac cursus commodo, tortor mauris condimentum nibh, ut fermentum massa justo sit amet risus.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Praesent commodo cursus magna, vel scelerisque nisl consectetur et.&lt;/li&gt;
  &lt;li&gt;Donec id elit non mi porta gravida at eget metus.&lt;/li&gt;
  &lt;li&gt;Nulla vitae elit libero, a pharetra augue.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Donec ullamcorper nulla non metus auctor fringilla. Nulla vitae elit libero, a pharetra augue.&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Vestibulum id ligula porta felis euismod semper.&lt;/li&gt;
  &lt;li&gt;Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus.&lt;/li&gt;
  &lt;li&gt;Maecenas sed diam eget risus varius blandit sit amet non magna.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Cras mattis consectetur purus sit amet fermentum. Sed posuere consectetur est at lobortis.&lt;/p&gt;

&lt;dl&gt;
  &lt;dt&gt;HyperText Markup Language (HTML)&lt;/dt&gt;
  &lt;dd&gt;The language used to describe and define the content of a Web page&lt;/dd&gt;

  &lt;dt&gt;Cascading Style Sheets (CSS)&lt;/dt&gt;
  &lt;dd&gt;Used to describe the appearance of Web content&lt;/dd&gt;

  &lt;dt&gt;JavaScript (JS)&lt;/dt&gt;
  &lt;dd&gt;The programming language used to build advanced Web sites and applications&lt;/dd&gt;
&lt;/dl&gt;

&lt;p&gt;Integer posuere erat a ante venenatis dapibus posuere velit aliquet. Morbi leo risus, porta ac consectetur ac, vestibulum at eros. Nullam quis risus eget urna mollis ornare vel eu leo.&lt;/p&gt;

&lt;h3 id=&quot;tables&quot;&gt;Tables&lt;/h3&gt;

&lt;p&gt;Aenean lacinia bibendum nulla sed consectetur. Lorem ipsum dolor sit amet, consectetur adipiscing elit.&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Name&lt;/th&gt;
      &lt;th&gt;Upvotes&lt;/th&gt;
      &lt;th&gt;Downvotes&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tfoot&gt;
    &lt;tr&gt;
      &lt;td&gt;Totals&lt;/td&gt;
      &lt;td&gt;21&lt;/td&gt;
      &lt;td&gt;23&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tfoot&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;Alice&lt;/td&gt;
      &lt;td&gt;10&lt;/td&gt;
      &lt;td&gt;11&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Bob&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;3&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Charlie&lt;/td&gt;
      &lt;td&gt;7&lt;/td&gt;
      &lt;td&gt;9&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;Nullam id dolor id nibh ultricies vehicula ut id elit. Sed posuere consectetur est at lobortis. Nullam quis risus eget urna mollis ornare vel eu leo.&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;Want to see something else added? &lt;a href=&quot;https://github.com/poole/poole/issues/new&quot;&gt;Open an issue.&lt;/a&gt;&lt;/p&gt;</content><author><name>è®¸ä¹¾éš†</name><email>qianlongxu@gmail.com</email></author><summary type="html">Howdy! This is an example blog post that shows several types of HTML content supported in this theme. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Aenean eu leo quam. Pellentesque ornare sem lacinia quam venenatis vestibulum. Sed posuere consectetur est at lobortis. Cras mattis consectetur purus sit amet fermentum. Curabitur blandit tempus porttitor. Nullam quis risus eget urna mollis ornare vel eu leo. Nullam id dolor id nibh ultricies vehicula ut id elit. Etiam porta sem malesuada magna mollis euismod. Cras mattis consectetur purus sit amet fermentum. Aenean lacinia bibendum nulla sed consectetur. Inline HTML elements HTML defines a long list of available inline tags, a complete list of which can be found on the Mozilla Developer Network. To bold text, use &amp;lt;strong&amp;gt;. To italicize text, use &amp;lt;em&amp;gt;. Abbreviations, like HTML should use &amp;lt;abbr&amp;gt;, with an optional title attribute for the full phrase. Citations, like â€” Mark otto, should use &amp;lt;cite&amp;gt;. Deleted text should use &amp;lt;del&amp;gt; and inserted text should use &amp;lt;ins&amp;gt;. Superscript text uses &amp;lt;sup&amp;gt; and subscript text uses &amp;lt;sub&amp;gt;. Most of these elements are styled by browsers with few modifications on our part. Heading Vivamus sagittis lacus vel augue rutrum faucibus dolor auctor. Duis mollis, est non commodo luctus, nisi erat porttitor ligula, eget lacinia odio sem nec elit. Morbi leo risus, porta ac consectetur ac, vestibulum at eros. Code Cum sociis natoque penatibus et magnis dis code element montes, nascetur ridiculus mus. // Example can be run directly in your JavaScript console // Create a function that takes two arguments and returns the sum of those arguments var adder = new Function(&quot;a&quot;, &quot;b&quot;, &quot;return a + b&quot;); // Call the function adder(2, 6); // &amp;gt; 8 Aenean lacinia bibendum nulla sed consectetur. Etiam porta sem malesuada magna mollis euismod. Fusce dapibus, tellus ac cursus commodo, tortor mauris condimentum nibh, ut fermentum massa. Lists Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Aenean lacinia bibendum nulla sed consectetur. Etiam porta sem malesuada magna mollis euismod. Fusce dapibus, tellus ac cursus commodo, tortor mauris condimentum nibh, ut fermentum massa justo sit amet risus. Praesent commodo cursus magna, vel scelerisque nisl consectetur et. Donec id elit non mi porta gravida at eget metus. Nulla vitae elit libero, a pharetra augue. Donec ullamcorper nulla non metus auctor fringilla. Nulla vitae elit libero, a pharetra augue. Vestibulum id ligula porta felis euismod semper. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Maecenas sed diam eget risus varius blandit sit amet non magna. Cras mattis consectetur purus sit amet fermentum. Sed posuere consectetur est at lobortis. HyperText Markup Language (HTML) The language used to describe and define the content of a Web page Cascading Style Sheets (CSS) Used to describe the appearance of Web content JavaScript (JS) The programming language used to build advanced Web sites and applications Integer posuere erat a ante venenatis dapibus posuere velit aliquet. Morbi leo risus, porta ac consectetur ac, vestibulum at eros. Nullam quis risus eget urna mollis ornare vel eu leo. Tables Aenean lacinia bibendum nulla sed consectetur. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Name Upvotes Downvotes Totals 21 23 Alice 10 11 Bob 4 3 Charlie 7 9 Nullam id dolor id nibh ultricies vehicula ut id elit. Sed posuere consectetur est at lobortis. Nullam quis risus eget urna mollis ornare vel eu leo. Want to see something else added? Open an issue.</summary></entry><entry><title type="html">Whatâ€™s Jekyll?</title><link href="http://localhost:4000/2013/12/31/whats-jekyll/" rel="alternate" type="text/html" title="What's Jekyll?" /><published>2013-12-31T00:00:00+08:00</published><updated>2013-12-31T00:00:00+08:00</updated><id>http://localhost:4000/2013/12/31/whats-jekyll</id><content type="html" xml:base="http://localhost:4000/2013/12/31/whats-jekyll/">&lt;p&gt;&lt;a href=&quot;http://jekyllrb.com&quot;&gt;Jekyll&lt;/a&gt; is a static site generator, an open-source tool for creating simple yet powerful websites of all shapes and sizes. From &lt;a href=&quot;https://github.com/mojombo/jekyll/blob/master/README.markdown&quot;&gt;the projectâ€™s readme&lt;/a&gt;:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Jekyll is a simple, blog aware, static site generator. It takes a template directory [â€¦] and spits out a complete, static website suitable for serving with Apache or your favorite web server. This is also the engine behind GitHub Pages, which you can use to host your projectâ€™s page or blog right here from GitHub.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Itâ€™s an immensely useful tool and one we encourage you to use here with Lanyon.&lt;/p&gt;

&lt;p&gt;Find out more by &lt;a href=&quot;https://github.com/mojombo/jekyll&quot;&gt;visiting the project on GitHub&lt;/a&gt;.&lt;/p&gt;</content><author><name>è®¸ä¹¾éš†</name><email>qianlongxu@gmail.com</email></author><summary type="html">Jekyll is a static site generator, an open-source tool for creating simple yet powerful websites of all shapes and sizes. From the projectâ€™s readme: Jekyll is a simple, blog aware, static site generator. It takes a template directory [â€¦] and spits out a complete, static website suitable for serving with Apache or your favorite web server. This is also the engine behind GitHub Pages, which you can use to host your projectâ€™s page or blog right here from GitHub. Itâ€™s an immensely useful tool and one we encourage you to use here with Lanyon. Find out more by visiting the project on GitHub.</summary></entry></feed>